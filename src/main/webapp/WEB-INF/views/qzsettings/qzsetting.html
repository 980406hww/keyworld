<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>全站信息设置</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link rel="stylesheet" href="${ctx.basePath}/static/ok-admin/lib/layui/css/layui.css"
          media="all">
    <link rel="stylesheet" href="${ctx.basePath}/static/ok-admin/lib/style/admin.css" media="all">
    <link rel="stylesheet" href="${ctx.basePath}/static/ok-admin/lib/style/template.css"
          media="all">
    <link rel="stylesheet" href="${ctx.basePath}/static/ok-admin/css/sub-page.css">
    <link rel="stylesheet" href="${ctx.basePath}/static/layui/add-or-upd.css">
    <style>
        .click-czcs{
            cursor: pointer;
        }

        .click-czcs:hover{
            color: #0c7df5;
        }

        .layui-tab-content {
            padding: 0px;
        }
        .layui-card-body {
            position: relative;
            padding: 0px;
            line-height: 24px;
        }
        .layui-table, .layui-table-view {
            margin: 0px;
            border-width: 0px;
        }
        .my-collapse > div:first-child {
            background: #f2f2f2;
            border: 0px;
        }

        *, :after, :before {
            box-sizing: border-box
        }

        html {
            background-color: white;
        }

        a {
            background-color: transparent;
            text-decoration: none
        }

        a:active, a:hover {
            outline: 0
        }

        a:hover {
            color: #0c7df5
        }

        input[type=checkbox] {
            box-sizing: border-box;
            padding: 0
        }

        label {
            vertical-align: middle
        }

        .layui-table-cell {
            height: auto;
            overflow: visible;
            text-overflow: inherit;
            white-space: normal;
            padding: 0 !important;
        }

        .layadmin-caller {
            background: #fff;
            padding: 0;
        }

        .layui-fluid {
            position: relative;
            margin: 0 0;
            padding: 0 0;
        }

        .layui-table td {
            padding: 0 !important;
        }

        .layui-table-body .layui-table-col-special {
            height: 195px;
        }

        .layui-table-col-special .header {
            width: 100%;
            height: 44px;
            border-bottom: 1px solid #e6e6e6;
        }

        .layui-table-col-special .header span {
            display: block;
            float: left;
            height: 44px;
            line-height: 44px
        }

        .layui-table-col-special .header span input {
            align-self: center;
            margin: 15px 5px;
        }

        .layui-table-col-special .header span a {
            font-size: 12px;
            margin: 0 5px;
        }

        .layui-table-col-special .header span.contactPerson-name,
        .layui-table-col-special .header span.tagNames,
        .layui-table-col-special .header span.organization-name {
            max-width: 110px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .layui-table-col-special .header span.contactPerson-name a,
        .layui-table-col-special .header span.organization-name a {
            font-weight: 700;
            color: #000000;
        }


        .layui-table-col-special .header span.domain {
            max-width: 120px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .layui-table-col-special .header span.domain a {
            color: #000000;
        }

        .layui-table-col-special .header span.to-aizhan {
            width: 35px;
            max-width: 35px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .layui-table-col-special .header span.domain a,
        .layui-table-col-special .header span.to-aizhan a,
        .layui-table-col-special .header span.to-5118 a {
            color: #0c7df5;
        }

        .layui-table-col-special .header span.to-5118 {
            width: 40px;
            max-width: 40px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .layui-table-col-special .header span.fmtStandardDate,
        .layui-table-col-special .header span.fmtCreateDate {
            max-width: 170px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .layui-table-col-special .header span.fmtStandardDate a,
        .layui-table-col-special .header span.fmtCreateDate a {
            color: #000000;
        }

        .layui-table-col-special .header span.fmtStandardDate a:hover,
        .layui-table-col-special .header span.fmtCreateDate a:hover {
            color: #0c7df5;
        }

        .layui-table-col-special .header .handle a {
            display: block;
            text-decoration: none;
            font-size: 14px;
        }

        .layui-table-col-special .header .handle {
            float: right;
            font-size: 14px;
        }

        .layui-table-col-special .header .handle a.blue {
            color: #1a81ea;
        }

        .layui-table-col-special .header .handle a.blue:hover {
            color: rgb(0, 150, 136);
        }

        .layui-table-col-special .body {
            height: 150px
        }

        .layui-table-col-special .body .user-id .line1,
        .layui-table-col-special .body .standard-info .line1 {
            text-align: center;
            height: 100px !important;
            margin-top: 50px;
            overflow: hidden;
            text-overflow: ellipsis;
            color: #000;
            font-size: 14px;
        }

        .layui-table-col-special .body .other-rank .line1,
        .layui-table-col-special .body .other-rank_2 .line1 {
            text-align: center;
            height: 65px !important;
            margin-top: 10px;
            overflow: hidden;
            text-overflow: ellipsis;
            color: #000;
        }

        .layui-table-col-special .body .other-rank .line1:first-child,
        .layui-table-col-special .body .other-rank_2 .line1:first-child {
            border-bottom: 1px solid #e6e6e6;
        }

        .layui-table-col-special .body .rank-wrap {
            width: 468px;
            float: left;
            height: 150px;
            border-left: 1px solid #e6e6e6;
        }

        .layui-table-col-special .body .rank-wrap1 {
            width: 400px;
            float: left;
            height: 150px;
            border-left: 1px solid #e6e6e6;
        }

        .layui-table-col-special .body .rank-wrap2 {
            width: 320px;
            float: left;
            height: 150px;
            border-left: 1px solid #e6e6e6;
        }

        .layui-table-col-special .body .rank-wrap > div,
        .layui-table-col-special .body .rank-wrap1 > div,
        .layui-table-col-special .body .rank-wrap2 > div {
            float: left;
            font-size: 12px;
            height: 150px;
            display: block;
        }

        .layui-table-col-special .body .rank-wrap > div,
        .layui-table-col-special .body .rank-wrap1 > div,
        .layui-table-col-special .body .rank-wrap2 > div {
            padding: 0 5px;
        }

        .layui-table-col-special .body .rank-wrap > div:last-child,
        .layui-table-col-special .body .rank-wrap1 > div:last-child {
            border-left: 1px dashed #e6e6e6;
        }

        .layui-table-col-special .body .rank-wrap > div .row4,
        .layui-table-col-special .body .rank-wrap1 > div .row4 {
            line-height: 2;
        }

        .layui-table-col-special .body .rank-wrap > div span:first-child,
        .layui-table-col-special .body .rank-wrap1 > div span:first-child {
            font-size: 12px;
            display: block;
            float: left;
            width: 42%;
            text-align: left;
        }

        .layui-table-col-special .body .rank-wrap > div span:last-child,
        .layui-table-col-special .body .rank-wrap1 > div span:last-child {
            font-size: 12px;
            display: block;
            float: left;
            width: 58%;
            text-align: left;
        }

        .layui-table-col-special .body .rank-wrap > div span:last-child,
        .layui-table-col-special .body .rank-wrap1 > div span:last-child {
            text-align: center;
        }

        .layui-table-col-special .body .user-id {
            width: 84px;
        }

        .layui-table-col-special .body .standard-info {
            width: 80px;
        }

        .layui-table-col-special .body .user-id,
        .layui-table-col-special .body .standard-info {
            float: left;
            border-right: 1px solid #e6e6e6;
            height: 150px;
            display: block;
        }

        .layui-table-col-special .body .user-id a,
        .layui-table-col-special .body .standard-info a {
            clear: both;
        }

        .layui-table-col-special .body .user-id span,
        .layui-table-col-special .body .standard-info span {
            display: block;
        }

        .layui-table-col-special .body .user-id span.line1,
        .layui-table-col-special .body .standard-info span.line1 {
            font-size: 14px;
            overflow: hidden;
            text-overflow: ellipsis;
            color: #000;
        }

        .layui-table-col-special .body .user-id span.line1:hover {
            color: #0c7df5;
        }

        .layui-table-col-special .body .standard-info a {
            color: #000;
        }

        .layui-table-col-special .body .other-rank {
            float: left;
            width: 84px;
        }

        .layui-table-col-special .body .other-rank_2 {
            float: left;
            width: 152px;
            border-left: 1px solid #e6e6e6;
        }

        .rank-wrap .col-4 {
            float: left;
            width: 29%;
            text-align: left;
        }

        .rank-wrap .col-2 {
            width: 71%;
            text-align: left;
        }

        .rank-wrap .col-1 h1, .rank-wrap .col-2 h1 {
            text-align: center;
            padding-top: 65px;
        }

        .rank-wrap1 .col-5 {
            float: left;
            width: 33%;
            text-align: left;
        }

        .rank-wrap1 .col-1 {
            width: 67%;
            text-align: left;
        }

        .rank-wrap1 .col-1 h1 {
            text-align: center;
            padding-top: 65px;
        }

        .rank-wrap2 .col-1 {
            width: 100%;
            text-align: left;
        }

        .layui-unselect {
            height: 30px;
        }

        .layui-table-tool {
            position: relative;
            z-index: 890;
            width: 100%;
            min-height: 30px;
            line-height: 30px;
            padding: 0 5px 10px 5px;
            border-width: 0 0 1px
        }

        .layui-form-select input {
            height: 30px;
        }

        .my-label {
            height: auto !important;
            max-width: 330px;
        }

        .layui-input-inline input {
            height: 30px;
        }

        .layui-form-pane .layui-form-label {
            height: 30px;
            line-height: 12px;
            width: 100px;
            padding: 8px 0;
        }

        div.layui-row.body .col-1 h5,
        div.layui-row.body .col-2 h5 {
            margin-top: 65px;
        }

        #optimizationGroup span,
        #operationCombine span {
            display: inline-block;
            width: 90%;
            word-break: keep-all;
            white-space: normal;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .layui-table-tool-temp .layui-btn + .layui-btn {
            margin-left: 0px
        }

        .layui-table-tool-temp .layui-btn-sm {
            padding: 0 5px;
        }

        .layui-card-body {
            padding: 0;
        }

        .layui-table-page > div {
            height: 26px;
            position: fixed;
            right: 25px;
        }

        .layui-form-pane .layui-form-checkbox{
            margin: 2px 0 !important;
        }

        .status-box .layui-form-checkbox[lay-skin=primary]{
            padding-left: 18px !important;
        }

        .status-box .layui-form-checkbox[lay-skin=primary] span{
            position: relative;
            top: -0.8px;
            padding-right: 3px;
        }

        .sort-box {
            line-height: 28px;
            padding-left: 84px;
            border-top: 1px solid #e6e6e6;
            border-right: 1px solid #e6e6e6;
            border-bottom: 1px solid #e6e6e6;
            background: #fff;
        }

        .status-box .layui-form-label{
            display: block !important;
            padding: 0 !important;
            text-align: center !important;
            line-height: 28px !important;
            width: 76px;
        }

        /* 客户满意度Tip */
        .tool-tip{
            display: inline-block;
            background-color: #009688;
            color: #fff;
            white-space: nowrap;
            text-align: center;
            border: none;
            cursor: default;
            outline: 0;
            -webkit-appearance: none;
            box-sizing: border-box;
            margin-left: 0 !important;
            margin-right: 0 !important;
            border-left: 1px solid rgba(255, 255, 255, .5);
            border-radius: 2px 0 0 2px;
            vertical-align: middle;
        }

        /* 下拉条件框 */
        .my-collapse {
            position: relative;
            box-shadow: none;
        }

        .my-collapse * {
            box-shadow: none;
        }

        .my-collapse .layui-form-select dl,
        .my-collapse .layui-form-select .layui-anim {
            top: 33px !important;
        }

        .my-collapse > div {
            padding: 6px 5px;
        }

        .my-hide {
            padding-bottom: 1px !important;
            width: 100%;
            display: none;
            position: absolute;
            top: 43px;
            left: 0;
            z-index: 894;
            background: #fff;
            border-left: 1px solid #e6e6e6;
            border-right: 1px solid #e6e6e6;
            border-bottom: 1px solid #e6e6e6;
            border-bottom-right-radius: 2px;
            border-bottom-left-radius: 2px;
        }

        .my-collapse button {
            height: 30px;
            line-height: 30px;
        }

        .my-collapse .my-btn {
            height: 30px !important;
            line-height: 30px !important;
            padding: 0 18px;
            background-color: #45a3c2;
            color: #fff;
            white-space: nowrap;
            text-align: center;
            font-size: 14px;
            border: none;
            border-radius: 2px;
            cursor: pointer;
        }

        .my-collapse .my-btn:hover {
            opacity: .8;
            transition: opacity 0.5s;
        }

        .my-collapse .layui-form-radio {
            margin: 0;
            padding-left: 6px;
            padding-right: 0;
        }

        .charge-status {
            margin: 15px 20px 0 0;
        }

        /* 五角心心评论 */
        .charge-status .clean-float::after {
            display: block;
            clear: both;
            content: "";
            visibility: hidden;
            height: 0;
        }

        .charge-status ul {
            position: relative;
            top: -2px;
        }

        /*清浮动*/
        .charge-status ul li {
            list-style: none;
            float: left;
            font-size: 30px;
            color: #d6d6d6;
            cursor: pointer;
            margin: 0;
            padding: 0 2px;
        }

        /*五角星样式*/
        .hs {
            color: #ffba00 !important;
        }

        .table-tips .layui-layer-content{
            padding: 8px !important;
        }

        .table-tips .layui-layer-content{
            background-color: #fff !important;
            color: #000 !important;
            font-size: 14px;
        }

        .table-tips .layui-layer-TipsG {
            display: none;
        }

        .table-tips .my-padding {
            padding: 2px 10px;
        }
    </style>
    <script>
        Date.prototype.format = function (fmt) {
            let o = {
                "M+": this.getMonth() + 1, //月份
                "d+": this.getDate(), //日
                "h+": this.getHours(), //小时
                "m+": this.getMinutes(), //分
                "s+": this.getSeconds(), //秒
                "q+": Math.floor((this.getMonth() + 3) / 3), //季度
                "S": this.getMilliseconds() //毫秒
            };
            if (/(y+)/.test(fmt)) {
                fmt = fmt.replace(RegExp.$1,
                    (this.getFullYear() + "").substr(4 - RegExp.$1.length));
            }
            for (let k in o) {
                if (new RegExp("(" + k + ")").test(fmt)) {
                    fmt = fmt.replace(RegExp.$1,
                        (RegExp.$1.length === 1) ? (o[k]) : (("00" + o[k]).substr(
                            ("" + o[k]).length)));
                }
            }
            return fmt;
        }
    </script>
</head>
<body>
<div class="ok-body">
    <div class="layui-tab layui-tab-card" lay-filter="tabQzsetting">
        <ul class="layui-tab-title">
            <li data-terminal="PC" lay-id="PC" style="width: 100px" class="layui-this">电脑</li>
            <li data-terminal="Phone" lay-id="Phone" style="width: 100px">手机</li>
        </ul>
        <div class="layui-tab-content">
            <div class="layui-tab-item layui-show">
                <div class="layui-card ">
                    <div class="layui-card-body ">
                        <form class="layui-form layui-form-pane" id="searchForm">
                            <div class="my-collapse">
                                <div>
                                    <div class="layui-inline" style="width: 120px;height: 30px">
                                        <select name="terminalSearchEngine" id="terminalSearchEngine" lay-filter="terminalSearchEngineFilter"></select>
                                    </div>
                                    <div class="layui-inline">
                                        <input type="text" name="domain" id="domain" placeholder="请输入域名"
                                               autocomplete="off" onblur="checkDomain()" style="width: 150px;height: 30px"
                                               onmouseleave="checkDomain()" class="layui-input" value="<#if domain?exists>${domain}</#if>">
                                    </div>
                                    <div class="layui-inline">
                                        <button class="layui-btn" lay-submit lay-filter="search" id="searchBtn">搜索</button>
                                    </div>
                                    <div class="layui-inline">
                                        <div class="layui-collapse my-btn" onclick="showCondition()">
                                            更多条件
                                        </div>
                                    </div>
                                    <div class="layui-inline" onclick="resetHidden()">
                                        <button style="background: #897c00;color: #ffffff" class="layui-btn" type="reset" id="resetBtn">
                                            重置
                                        </button>
                                    </div>
                                    <div class="layui-inline status-box">
                                            <div class="layui-inline" style="margin-left: 4px">
                                                <label class="layui-form-label layui-bg-green">暴涨暴跌</label>
                                                <div class="sort-box" style="min-width: 338px">
                                                    <input type="checkbox" name="bzbtSort" value="1" title="骤降(0)" lay-filter="bzbtSort" lay-skin="primary">
                                                    <input type="checkbox" name="bzbtSort" value="2" title="无变化(0)" lay-filter="bzbtSort" lay-skin="primary">
                                                    <input type="checkbox" name="bzbtSort" value="3" title="暴涨(0)" lay-filter="bzbtSort" lay-skin="primary">
                                                </div>
                                            </div>
                                            <div class="layui-inline">
                                                <label class="layui-form-label layui-bg-green">今日趋势</label>
                                                <div class="sort-box"style="min-width: 322px">
                                                    <input type="checkbox" name="jrqsSort" value="7" title="下降(0)" lay-filter="jrqsSort" lay-skin="primary">
                                                    <input type="checkbox" name="jrqsSort" value="8" title="不变(0)" lay-filter="jrqsSort" lay-skin="primary">
                                                    <input type="checkbox" name="jrqsSort" value="9" title="上升(0)" lay-filter="jrqsSort" lay-skin="primary">
                                                </div>
                                            </div>
                                            <div class="layui-inline">
                                                <label class="layui-form-label layui-bg-green">达标统计</label>
                                                <div class="sort-box" style="min-width: 364px">
                                                    <input type="checkbox" name="dbtjSort" value="4" title="达标(0)" lay-filter="dbtjSort" lay-skin="primary">
                                                    <input type="checkbox" name="dbtjSort" value="5" title="未达标(0)" lay-filter="dbtjSort" lay-skin="primary">
                                                    <input type="checkbox" name="dbtjSort" value="6" title="接近达标(0)" lay-filter="dbtjSort" lay-skin="primary">
                                                </div>
                                            </div>
                                    </div>
                                </div>
                                <div class="my-hide" id="searchContent">
                                    <input type="hidden" name="searchEngine" id="searchEngine" value="<#if searchEngineTmp?exists>${searchEngineTmp}<#else>百度</#if>"/>
                                    <input type="hidden" name="terminalType" id="terminalType" value="<#if terminalTypeTmp?exists>${terminalTypeTmp}<#else>PC</#if>"/>
                                    <input type="hidden" name="userInfoID" id="userInfoID" value="">
                                    <input type="hidden" name="organizationID" id="organizationID" value="">
                                    <input hidden value='<#if Request.customerUuidTmp?exists>${Request.customerUuidTmp}</#if>' id="customerUuidTmp">
                                    <div class="layui-form-item" style="margin-bottom: 0" lay-filter="loginNameFilter">
                                        <div class="layui-inline">
                                            <label class="layui-form-label">客户</label>
                                            <div class="layui-input-inline">
                                                <select name="customerUuid" id="customerUuid" lay-filter="customerUuidFilter" lay-search>
                                                </select>
                                            </div>
                                        </div>
                                        <@shiro.hasPermission name = "/internal/qzsetting/deleteQZSettings">
                                        <div class="layui-inline">
                                            <label class="layui-form-label">用户</label>
                                            <div class="layui-input-inline">
                                                <input type="text" id="tree" lay-filter="tree" class="layui-input">
                                            </div>
                                        </div>
                                        </@shiro.hasPermission>
                                    <div class="layui-inline">
                                        <label class="layui-form-label">分类标签</label>
                                        <div class="layui-input-inline">
                                            <select name="categoryTag" id="categoryTag"
                                                    lay-filter="categoryTagFilter" lay-search>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="layui-inline">
                                        <label class="layui-form-label">组名</label>
                                        <div class="layui-input-inline">
                                            <input type="text" name="group" id="group" placeholder="请输入组名"
                                                   autocomplete="off" class="layui-input">
                                        </div>
                                    </div>
                                    <div class="layui-inline">
                                        <label class="layui-form-label">续费状态</label>
                                        <div class="layui-input-inline">
                                            <select name="renewalStatus" id="renewalStatus">
                                                <option value="" selected>全部</option>
                                                <option value="11">首次+续费中+其他</option>
                                                <option value="12">首次+续费中</option>
                                                <option value="2">首次续费</option>
                                                <option value="1">续费中</option>
                                                <option value="0">暂停续费</option>
                                                <option value="3">下架</option>
                                                <option value="4">其他</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="layui-inline">
                                        <label class="layui-form-label">自动采词</label>
                                        <div class="layui-input-inline">
                                            <select name="autoCrawlKeywordFlag" id="autoCrawlKeywordFlag">
                                                <option value selected>全部</option>
                                                <option value="true">是</option>
                                                <option value="false">否</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="layui-inline">
                                        <label class="layui-form-label">达标种类</label>
                                        <div class="layui-input-inline">
                                            <select name="standardSpecies" id="standardSpecies">
                                                <option value selected>全部</option>
                                                <option value="aiZhan">爱站</option>
                                                <option value="5118">5118</option>
                                                <option value="designationWord">指定词</option>
                                                <option value="other">其它</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="layui-inline">
                                        <label class="layui-form-label">创建时间</label>
                                        <div class="layui-input-inline" style="width: 90.5px;">
                                            <input type="text" name="createTime" id="createTime" placeholder="起始日期" autocomplete="off" class="layui-input">
                                        </div>
                                        <div class="layui-input-inline" style="width: 90.5px;">
                                            <input type="text" name="createTimePrefix" id="createTimePrefix" placeholder="结束日期" autocomplete="off" class="layui-input">
                                        </div>
                                    </div>

                                    <div class="layui-inline">
                                        <label class="layui-form-label">达标优化类型</label>
                                        <div class="layui-input-inline">
                                            <select name="optimizationType" id="optimizationType">
                                                <option value selected>全部</option>
                                                <option value="1">主优化</option>
                                                <option value="2">次优化</option>
                                                <option value="0">辅助优化</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="layui-inline">
                                        <label class="layui-form-label">更新状态</label>
                                        <div class="layui-input-inline">
                                            <select name="updateStatus" id="updateStatus">
                                                <option></option>
                                                <option>Processing</option>
                                                <option>Completed</option>
                                                <option>DownloadTimesUsed</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <!--数据表格-->
                <table class="layui-hide" id="qzSettingTable" lay-filter="tableFilter"></table>
            </div>
        </div>
    </div>
</div>

<script src="${ctx.basePath}/static/ok-admin/lib/layui/layui.js"></script>
<script src="/static/ok-admin/js/somePublic.js"></script>
<script type="text/javascript" src="${ctx.basePath}/static/ok-admin/lib/echarts/echarts.min.js"></script>
<script>
    let s_c = 0;

    function showCondition() {
        let searchContent = document.getElementById('searchContent');
        if (s_c++ % 2 === 0) {
            searchContent.style.display = 'block';
        } else {
            searchContent.style.display = 'none';
        }
    }

    function resetHidden() {
        document.getElementById('searchEngine').value = '<#if searchEngineTmp?exists>${searchEngineTmp}<#else>百度</#if>';
        document.getElementById('userInfoID').value = '';
        document.getElementById('organizationID').value = '';
    }

    var sign = false;
    var noteAddRow = true;
    var toUpdateQZSettingFromData = null;
    // layui相关
    layui.use(['element', 'table', 'form', 'jquery', 'okLayer', 'layer', 'treeSelect', 'laydate', 'common'], function () {
        var element = layui.element;
        var table = layui.table;
        var form = layui.form;
        var $ = layui.jquery;
        var okLayer = layui.okLayer;
        var treeSelect = layui.treeSelect;
        var layer = layui.layer;
        var laydate = layui.laydate;
        var common = layui.common;

        laydate.render({elem: '#createTime'});
        laydate.render({elem: '#createTimePrefix'});

        let customerUuidTmp = $("#customerUuidTmp").val();
        if (customerUuidTmp) {
            let whereCondition = {searchEngine: 'All'};
            whereCondition.customerUuid = customerUuidTmp;
            whereCondition.terminalType = $("#terminalType").val();
            get_qzsetting(whereCondition);
            getTerminalSearchEngineMap(whereCondition.terminalType, whereCondition.searchEngine);
            element.tabChange('tabQzsetting', whereCondition.terminalType);
        } else {
            get_qzsetting({init: 'init'});
            getTerminalSearchEngineMap('PC', "百度");
        }

        /*动态加载tab栏*/
        function getTerminalSearchEngineMap(terminal, searchEngine) {
            $.ajax({
                url: '/internal/qzsetting/getQZSettingSearchEngineMap/' + terminal,
                type: 'get',
                asyns: false,
                // 用于设置响应体的类型 注意 跟 data 参数没关系！！！
                dataType: 'json',
                success: function (res) {
                    if (res.code === 200) {
                        let data = res.data;
                        let terminalSearchEngine = $('#terminalSearchEngine');
                        terminalSearchEngine.empty();
                        $.each(data, function (index, item) {
                            let ttse = item.searchEngineName.replace(terminal, '');
                            if (ttse === searchEngine) {
                                terminalSearchEngine.append('<option value="' + ttse + '" selected>' + ttse + '</option>');
                            } else {
                                terminalSearchEngine.append('<option value="' + ttse + '">' + ttse + '</option>');// 下拉菜单里添加元素
                            }
                        });
                        form.render("select");
                    } else {
                        common.showFailMsg('搜索引擎列表获取失败');
                    }
                }
            });
        }

        <@shiro.hasPermission name = "/internal/qzsetting/deleteQZSettings">
        treeSelect.render({
            elem: '#tree',
            data: '/internal/user/trees2',
            type: 'get',
            placeholder: '用户名称',
            click: function (d) {
                $("#organizationID").val("");
                $("#userInfoID").val("");
                if (d.current.level === 0 && d.current.id !== 0) {
                    $("#organizationID").val(d.current.id)
                } else if (d.current.level === 1) {
                    $("#userInfoID").val(d.current.id)
                }
            },
            success: function (d) {
            }
        });
        </@shiro.hasPermission>

        window.checkDomain = function () {
            var domain = $("#domain").val().replace(/\s*/g, "");
            if (domain != null && domain !== '') {
                if (domain.indexOf(".") === -1) {
                    common.showFailMsg('域名不符合规范');
                }
            }
        };

        /*动态加载网站分类标签列表*/
        function get_qzcategory_label_list(categoryTag) {
            $.ajax({
                url: '${ctx.path}/internal/qzsetting/getCategoryTag',
                dataType: 'json',
                type: 'get',
                success: function (res) {
                    if (res.code === 200) {
                        $("#categoryTag").empty();
                        $("#categoryTag").append('<option value="">分类标签</option>');
                        $.each(res.data, function (index, item) {
                            $('#categoryTag').append(
                                '<option value="' + item + '">' + item.trim() + '</option>');
                        });
                        $("#categoryTag").val(categoryTag);
                        form.render("select");
                    }
                }
            });
        }

        /*动态加载客户列表*/
        function get_active_customer_list(customerUuid) {
            $.ajax({
                url: '${ctx.path}/internal/qzsetting/getActiveCustomer',
                dataType: 'json',
                type: 'get',
                success: function (res) {
                    if (res.code === 200) {
                        toUpdateQZSettingFromData = res.data;
                        $("#customerUuid").empty();
                        $("#customerUuid").append('<option value="">客户</option>');
                        $.each(res.data, function (index, item) {
                            $('#customerUuid').append(
                                '<option value="' + item.uuid + '">' + item.contactPerson.trim()
                                + '</option>');
                        });
                        $("#customerUuid").val(customerUuid);
                        form.render("select");
                    }
                }
            });
        }

        form.on("submit(search)", function (data) {
            data.field = common.jsonObjectTrim(data.field);
            data.field.domain.replace(/\s*/g, "");
            data.field.customerUuid.replace(/\s*/g, "");
            data.field.categoryTag.replace(/\s*/g, "");

            if (!data.field.createTimePrefix) {
                data.field.createTimePrefix = '';
            } else {
                data.field.createTimePrefix += ' 23:59:59';
            }
            if (data.field.domain != null && data.field.domain !== '') {
                if (data.field.domain.indexOf(".") === -1) {
                    common.showFailMsg('域名不符合规范');
                    return false;
                }
            }
            if (!data.field.bzbtSort){
                data.field.bzbtSort = null;
            }
            if (!data.field.jrqsSort){
                data.field.jrqsSort = null;
            }
            if (!data.field.dbtjSort){
                data.field.dbtjSort = null;
            }
            get_qzsetting(data.field);
            return false;
        });

        <@shiro.hasPermission name = "/internal/qzsetting/searchQZSettings" >
            function get_qzsetting(whereCondition) {
                table.render({
                    elem: '#qzSettingTable',
                    method: 'post',
                    url: '/internal/qzsetting/getQZSettings',
                    limit: 25,
                    limits: [10, 25, 50, 75, 100, 500, 1000],
                    page: true,
                    size: 'sm',
                    id: 'qzSettingTable',
                    toolbar: "#toolbarTpl",
                    defaultToolbar: [],
                    contentType: 'application/json',
                    where: whereCondition,
                    cols: [[
                        {filed: 'uuid', type: 'checkbox', fixed: "left", width: '2%'},
                        {filed: 'uuid', title: '记录', width: '98%', templet: '#item'}
                    ]],
                    height: 'full-105',
                    loading: true,
                    done: function (res, curr, count) {
                        console.log(res);
                        successTable(res, whereCondition);
                        initSortRadio(whereCondition);
                    }
                });
            }
        </@shiro.hasPermission>

        function successTable(res, whereCondition) {
            let terminalType = $('#terminalType').val();
            terminalType = terminalType === '' ? 'PC' : terminalType;
            get_operation_combine_list(terminalType);
            get_qzcategory_label_list(whereCondition.categoryTag);
            get_active_customer_list(whereCondition.customerUuid);
            let qz_setting_table = $("#qzSettingTable").parent().find(".layui-table-main").find("table");
            $.each(res.data, function (idx, val) {
                let td = qz_setting_table.find("tr[data-index='" + val.LAY_TABLE_INDEX + "']").find("td[data-field='1']");
                let optimizeGroupName = td.find("input[name='" + terminalType + "Group']").val();
                let postData = {};
                postData.uuid = val.uuid;
                postData.terminalType = terminalType;
                postData.optimizeGroupName = optimizeGroupName;
                postData.customerUuid = td.find("#cus_uuid").val();
                getQZKeywordRankInfo(postData, function (result) {
                    td.find(".other-rank_2").find("#optimizationGroup span").prop("title", optimizeGroupName);
                    td.find(".other-rank_2").find("#optimizationGroup span a").text(optimizeGroupName);
                    if (result.data != null) {
                        initQZKeywordRankInfo(result.data, td);
                    }
                });
            });
        }

        function initSortRadio(condition) {
            let bzbtSort = document.getElementsByName('bzbtSort');
            let jrqsSort = document.getElementsByName('jrqsSort');
            let dbtjSort = document.getElementsByName('dbtjSort');
            $.ajax({
                url: '/internal/qzkeywordrank/searchCountNumOfQZKeywordRankInfoNew',
                type: 'POST',
                data: JSON.stringify(condition),
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                success: function (res) {
                    if (res.code === 200) {
                        bzbtSort[0].title = "骤降(" + res.data.downNum + ")";
                        bzbtSort[1].title = "无变化(" + res.data.unchangedNum + ")";
                        bzbtSort[2].title = "暴涨(" + res.data.upNum + ")";
                        jrqsSort[0].title = "下降(" + res.data.downDifferenceNum + ")";
                        jrqsSort[1].title = "不变(" + res.data.unchangedDifferenceNum + ")";
                        jrqsSort[2].title = "上升(" + res.data.upDifferenceNum + ")";
                        dbtjSort[0].title = "达标(" + res.data.atLeastStandardNum + ")";
                        dbtjSort[1].title = "未达标(" + res.data.neverStandardNum + ")";
                        dbtjSort[2].title = "接近达标(" + res.data.closeStandardNum + ")";
                        form.render('radio');
                        bzbtSort[0].nextElementSibling.title = "网站关键词(PC,Phone)一星期排名趋势涨幅<"
                            + res.data.upperValue + ", 且下降至少" + res.data.upOneWeekDiff + "个词";
                        bzbtSort[1].nextElementSibling.title = "网站关键词(PC,Phone)一星期排名趋势涨幅不变";
                        bzbtSort[2].nextElementSibling.title = "网站关键词(PC,Phone)一星期排名趋势涨幅>"
                            + res.data.upperValue + ", 且上涨至少" + res.data.upOneWeekDiff + "个词";
                        jrqsSort[0].nextElementSibling.title = "网站关键词(PC,Phone)今天前10下降";
                        jrqsSort[1].nextElementSibling.title = "网站关键词(PC,Phone)今天前10不变";
                        jrqsSort[2].nextElementSibling.title = "网站关键词(PC,Phone)今天前10上升";
                        dbtjSort[0].nextElementSibling.title = "标识最少有一条规则达标";
                        dbtjSort[1].nextElementSibling.title = "标识一条规则都未达标";
                        dbtjSort[2].nextElementSibling.title = "标识下条规则接近达标, 未完成度<"
                            + res.data.differenceValue;
                        form.render('checkbox');
                    } else {
                        common.showFailMsg('数据获取失败');
                    }
                },
                error: function () {
                    common.showFailMsg('网络异常请稍后再试');
                }
            });
        }
        
        function initQZKeywordRankInfo(data, td) {
            td.find("#fmtStandardDate a").text(data["standardTime"] === null ? "无" : toDateFormat(new Date(data["standardTime"])));
            let font = td.find(".standard-info").find("div.line1 a font");
            font.text(data["price"] ? "￥ " + data["price"] : "￥ " + 0);
            if (data["price"] > 0) {
                font.css("background-color", "mediumseagreen");
            }

            initQZSettingKeywordCount(td.find(".other-rank_2"), data["customerKeywordCount"], data["categoryTagNames"], data["operationCombineName"]);

            if (data['aiZhan'] !== undefined) {
                generateQZKeywordTrendCharts(td.find("#keywordTrendCharts")[0], data['aiZhan']);
            }

            if (data['5118'] !== undefined) {
                generateQZKeywordTrendCharts(td.find("#keywordTrendCharts")[0], data['5118']);
            }

            if (data['designationWord'] === undefined) {
                td.find("div.rank-wrap1").css("display", "none");
            } else {
                // 指定词曲线
                generateQZDesignationWordTrendCharts(td.find("#designationWordCharts")[0], data['designationWord']);
            }

            if (data['xt'] === undefined) {
                td.find("div.rank-wrap2").css("display", "none");
            } else {
                // 排名-操作词数图表
                generateQZXTKeywordTrendCharts(td.find("#xtCharts")[0], data['xt']);
            }
        }

        /*动态加载操作组合列表*/
        function get_operation_combine_list(terminalType) {
            $.ajax({
                url: '/internal/operationcombine/getOperationCombines/' + terminalType,
                type: 'get',
                asyns: true,
                dataType: 'json',
                success: function (res) {
                    if (res.code === 200) {
                        let operation_combine_select = $("#update_qz_operation_combine");
                        operation_combine_select.append("<option value='null'>置空</option>");
                        $.each(res.data, function (i, v) {
                            let option = $("<option value='" + v.uuid + "'>" + v.operationCombineName + "</option>");
                            operation_combine_select.append(option);
                        });
                        form.render("select");
                    }
                }
            });
        }

        form.on('checkbox(bzbtSort)', function (data) {
            let bzbtSort = document.getElementsByName('bzbtSort');
            if (data.elem.checked) {
                for (let i = 0; i < 3; i++) {
                    if (bzbtSort[i].value !== data.value) {
                        bzbtSort[i].checked = false;
                    }
                }
            }
            form.render("checkbox");
            active['reload'].call(this);
        });

        form.on('checkbox(jrqsSort)', function (data) {
            let jrqsSort = document.getElementsByName('jrqsSort');
            if (data.elem.checked) {
                for (let i = 0; i < 3; i++) {
                    if (jrqsSort[i].value !== data.value) {
                        jrqsSort[i].checked = false;
                    }
                }
            }
            form.render("checkbox");
            active['reload'].call(this);
        });

        form.on('checkbox(dbtjSort)', function (data) {
            let dbtjSort = document.getElementsByName('dbtjSort');
            if (data.elem.checked) {
                for (let i = 0; i < 3; i++) {
                    if (dbtjSort[i].value !== data.value) {
                        dbtjSort[i].checked = false;
                    }
                }
            }
            form.render("checkbox");
            active['reload'].call(this);
        });

        form.on('select(terminalSearchEngineFilter)', function (data) {
            document.getElementById('searchEngine').value = data.value;
            active['reload'].call(this);
        });

        element.on('tab(tabQzsetting)', function (data) {
            let terminalType = data.elem.context.dataset.terminal;
            $('#terminalType').val(terminalType);
            let searchEngineTmp = '<#if searchEngineTmp?exists>${searchEngineTmp}<#else>百度</#if>';
            getTerminalSearchEngineMap(terminalType, searchEngineTmp);
            $('#searchEngine').val(searchEngineTmp);
            active['reload'].call(this);
        });

        var active = {
            reload: function () {
                if (table.index >= 1) {
                    let condition = common.formToJsonObject("searchForm");
                    if (!condition.bzbtSort) {
                        condition.bzbtSort = null;
                    }
                    if (!condition.jrqsSort) {
                        condition.jrqsSort = null;
                    }
                    if (!condition.dbtjSort) {
                        condition.dbtjSort = null;
                    }
                    table.reload('qzSettingTable', {
                        where: condition,
                        page: {
                            curr: 1 //从第一页开始
                        }, done: function (res, curr, c) {
                            successTable(res, condition);
                            initSortRadio(condition);
                        }
                    });
                }
            }
        };

        function getQZKeywordRankInfo(postData, callback) {
            $.ajax({
                url: '/internal/qzsetting/getQZKeywordRankInfo',
                type: 'POST',
                data: JSON.stringify(postData),
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                success: function (result) {
                    callback(result);
                },
                error: function () {
                    common.showFailMsg('网络异常请稍后再试');
                }
            });
        }

        function generateQZKeywordTrendCharts(domElement, data) {
            if (domElement === undefined) {
                return;
            }
            if (data.date == null) {
                domElement.innerHTML = "<h5 style='text-align: center'> 暂无数据 </h5>";
                return;
            }
            var keywordTrendCharts = echarts.init(domElement);
            var option;
            var parentElement = $(domElement).parent()[0];
            $(parentElement).find("#Top10").text(data.topTen[data.topTen.length - 1]);
            $(parentElement).find("#Top50").text(data.topFifty[data.topFifty.length - 1]);
            $(parentElement).find("#TopCreate10").text(data.createTopTenNum);
            $(parentElement).find("#TopCreate50").text(data.createTopFiftyNum);
            if (data.dataProcessingStatus) {
                $(parentElement).find("#IsStandard").text((data.achieveLevel == null || data.achieveLevel === 0) ? "否" : "是");
                $(parentElement).find("#StandardTime").text(
                    data.achieveTime === null ? "无" : toDateFormat(new Date(data.achieveTime)));
            } else {
                $(parentElement).find("#IsStandard").parent().parent().css("display", "none");
                $(parentElement).find("#StandardTime").parent().parent().css("display", "none");
            }
            if (data.websiteType === "aiZhan") {
                option = {
                    color: ['#228B22', '#0000FF', '#FF6100', '#000000', '#FF0000'],
                    title: {
                        text: '爱站 - 关键词排名趋势',
                        textStyle: {
                            color: '#999',
                            fontFamily: "Arial",
                            fontWeight: 400,
                            fontSize: 12
                        },
                        x: 'center',
                        bottom: -3
                    },
                    tooltip: {
                        trigger: 'axis',
                        confine: true,
                        position: function (point, params, dom, rect, size) {
                            return [point[0] + 20, '-15%'];
                        }
                    },
                    grid: {
                        x: 6,
                        y: 15,
                        x2: 6,
                        y2: 4,
                        containLabel: true
                    },
                    toolbox: {
                        show: false,
                        feature: {
                            saveAsImage: {}
                        }
                    },
                    xAxis: {
                        show: false,
                        type: 'category',
                        axisLine: {
                            show: false,
                            lineStyle: {
                                color: '#404A59'
                            }
                        },
                        axisTick: {
                            show: false
                        },
                        boundaryGap: true,
                        data: data.date
                    },
                    yAxis: [
                        {
                            show: true,
                            type: 'value',
                            name: '关键字排名曲线',
                            position: 'left',
                            axisLine: {
                                show: false,
                                lineStyle: {
                                    color: '#404A59'
                                }
                            },
                            splitLine: {
                                show: true,
                                lineStyle: {
                                    color: '#DCDCDC',
                                    width: 1,
                                    type: 'solid'
                                }
                            },
                            axisTick: {
                                show: false
                            },
                            axisLabel: {
                                fontStyle: 'italic',
                                textStyle: {
                                    color: '#000'
                                }
                            }
                        }/*,
                        {
                            show: true,
                            type: 'value',
                            name: '收录曲线',
                            position: 'right',
                            axisLine: {
                                show: false,
                                lineStyle: {
                                    color: '#404A59'
                                }
                            },
                            splitLine: {
                                show: true,
                                lineStyle: {
                                    color: '#DCDCDC',
                                    width: 1,
                                    type: 'solid'
                                }
                            },
                            axisTick: {
                                show: false
                            },
                            axisLabel: {
                                fontStyle: 'italic',
                                textStyle: {
                                    color: '#000'
                                }
                            }
                        }*/
                    ],
                    series: [
/*                        {
                            name: '收录',
                            smooth: true,
                            type: 'line',
                            yAxisIndex: 1,
                            symbolSize: 3,
                            symbol: 'none',
                            data: data.baiduRecord,
                            lineStyle: {
                                type: "solid",
                                width: 1,
                                normal: {
                                    width: 3
                                }
                            }
                        },*/
                        {
                            name: '前10',
                            smooth: true,
                            type: 'line',
                            yAxisIndex: 0,
                            symbolSize: 1,
                            symbol: 'none',
                            data: data.topTen,
                            lineStyle: {
                                type: "solid",
                                width: 1
                            }
                        },
                        {
                            name: '前20',
                            smooth: true,
                            type: 'line',
                            yAxisIndex: 0,
                            symbolSize: 1,
                            symbol: 'none',
                            data: data.topTwenty,
                            lineStyle: {
                                type: "solid",
                                width: 1
                            }
                        },
                        {
                            name: '前30',
                            smooth: true,
                            type: 'line',
                            yAxisIndex: 0,
                            symbolSize: 1,
                            symbol: 'none',
                            data: data.topThirty,
                            lineStyle: {
                                type: "solid",
                                width: 1
                            }
                        },
                        {
                            name: '前40',
                            smooth: true,
                            type: 'line',
                            yAxisIndex: 0,
                            symbolSize: 1,
                            symbol: 'none',
                            data: data.topForty,
                            lineStyle: {
                                type: "solid",
                                width: 1
                            }
                        },
                        {
                            name: '前50',
                            smooth: true,
                            type: 'line',
                            yAxisIndex: 0,
                            symbolSize: 1,
                            symbol: 'none',
                            data: data.topFifty,
                            lineStyle: {
                                type: "solid",
                                width: 1
                            }
                        }
                    ]
                };
            } else if (data.websiteType === "5118") {
                option = {
                    color: ['#228B22', '#0000FF', '#FF6100', '#FF0000'],
                    title: {
                        text: data.websiteType + ' - 关键词排名趋势',
                        textStyle: {
                            color: '#999',
                            fontFamily: "Arial",
                            fontWeight: 400,
                            fontSize: 12
                        },
                        x: 'center',
                        bottom: -3
                    },
                    tooltip: {
                        trigger: 'axis',
                        confine: true,
                        position: function (point, params, dom, rect, size) {
                            return [point[0] + 20, '-15%'];
                        }
                    },
                    grid: {
                        x: 6,
                        y: 15,
                        x2: 6,
                        y2: 4,
                        containLabel: true
                    },
                    toolbox: {
                        show: false,
                        feature: {
                            saveAsImage: {}
                        }
                    },
                    xAxis: {
                        show: false,
                        type: 'category',
                        axisLine: {
                            show: false,
                            lineStyle: {
                                color: '#404A59'
                            }
                        },
                        axisTick: {
                            show: false
                        },
                        boundaryGap: true,
                        data: data.date
                    },
                    yAxis: [
                        {
                            show: true,
                            type: 'value',
                            name: '关键字排名曲线',
                            position: 'left',
                            axisLine: {
                                show: false,
                                lineStyle: {
                                    color: '#404A59'
                                }
                            },
                            splitLine: {
                                show: true,
                                lineStyle: {
                                    color: '#DCDCDC',
                                    width: 1,
                                    type: 'solid'
                                }
                            },
                            axisTick: {
                                show: false
                            },
                            axisLabel: {
                                fontStyle: 'italic',
                                textStyle: {
                                    color: '#000'
                                }
                            }
                        }/*,
                        {
                            show: true,
                            type: 'value',
                            name: '收录曲线',
                            position: 'right',
                            axisLine: {
                                show: false,
                                lineStyle: {
                                    color: '#404A59'
                                }
                            },
                            splitLine: {
                                show: true,
                                lineStyle: {
                                    color: '#DCDCDC',
                                    width: 1,
                                    type: 'solid'
                                }
                            },
                            axisTick: {
                                show: false
                            },
                            axisLabel: {
                                fontStyle: 'italic',
                                textStyle: {
                                    color: '#000'
                                }
                            }
                        }*/
                    ],
                    series: [
/*                        {
                            name: '收录',
                            smooth: true,
                            type: 'line',
                            yAxisIndex: 1,
                            symbolSize: 3,
                            symbol: 'none',
                            data: data.baiduRecord,
                            lineStyle: {
                                type: "solid",
                                width: 1,
                                normal: {
                                    width: 3
                                }
                            }
                        },*/
                        {
                            name: '前10',
                            smooth: true,
                            type: 'line',
                            yAxisIndex: 0,
                            symbolSize: 1,
                            symbol: 'none',
                            data: data.topTen,
                            lineStyle: {
                                type: "solid",
                                width: 1
                            }
                        },
                        {
                            name: '前20',
                            smooth: true,
                            type: 'line',
                            yAxisIndex: 0,
                            symbolSize: 1,
                            symbol: 'none',
                            data: data.topTwenty,
                            lineStyle: {
                                type: "solid",
                                width: 1
                            }
                        },
                        {
                            name: '前50',
                            smooth: true,
                            type: 'line',
                            yAxisIndex: 0,
                            symbolSize: 1,
                            symbol: 'none',
                            data: data.topFifty,
                            lineStyle: {
                                type: "solid",
                                width: 1
                            }
                        },
                        {
                            name: '前100',
                            smooth: true,
                            type: 'line',
                            yAxisIndex: 0,
                            symbolSize: 1,
                            symbol: 'none',
                            data: data.topHundred,
                            lineStyle: {
                                type: "solid",
                                width: 1
                            }
                        }
                    ]
                };
            }
            keywordTrendCharts.setOption(option);
        }

        function generateQZDesignationWordTrendCharts(domElement, data) {
            if (domElement === undefined) {
                return;
            }
            if (data.date == null) {
                domElement.innerHTML = "<h5 style='text-align: center'> 暂无数据 </h5>";
                return;
            }
            var designationWordTrendCharts = echarts.init(domElement);
            var option;
            var parentElement = $(domElement).parent()[0];
            $(parentElement).find("#Top10").text(data.topTen[data.topTen.length - 1]);
            $(parentElement).find("#Top50").text(data.topFifty[data.topFifty.length - 1]);
            $(parentElement).find("#TopCreate10").text(data.createTopTenNum);
            $(parentElement).find("#TopCreate50").text(data.createTopFiftyNum);
            $(parentElement).find("#IsStandard").text((data.achieveLevel == null || data.achieveLevel === 0) === 0 ? "否" : "是");
            $(parentElement).find("#StandardTime").text(
                data.achieveTime === null ? "无" : toDateFormat(new Date(data.achieveTime)));
            option = {
                color: ['#228B22', '#0000FF', '#FF6100', '#000000', '#FF0000'],
                title: {
                    text: '指定词排名趋势',
                    textStyle: {
                        color: '#999',
                        fontFamily: "Arial",
                        fontWeight: 400,
                        fontSize: 12
                    },
                    x: 'center',
                    bottom: -3
                },
                tooltip: {
                    trigger: 'axis',
                    confine: true,
                    position: function (point, params, dom, rect, size) {
                        return [point[0] + 20, '-15%'];
                    }
                },
                grid: {
                    x: 6,
                    y: 15,
                    x2: 6,
                    y2: 4,
                    containLabel: true
                },
                toolbox: {
                    show: false,
                    feature: {
                        saveAsImage: {}
                    }
                },
                xAxis: {
                    show: false,
                    type: 'category',
                    axisLine: {
                        show: false,
                        lineStyle: {
                            color: '#404A59'
                        }
                    },
                    axisTick: {
                        show: false
                    },
                    boundaryGap: true,
                    data: data.date
                },
                yAxis: {
                    show: true,
                    type: 'value',
                    axisLine: {
                        show: false,
                        lineStyle: {
                            color: '#404A59'
                        }
                    },
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: '#DCDCDC',
                            width: 1,
                            type: 'solid'
                        }
                    },
                    axisTick: {
                        show: false
                    },
                    axisLabel: {
                        fontStyle: 'italic',
                        textStyle: {
                            color: '#000'
                        }
                    }
                },
                series: [
                    {
                        name: '前10',
                        smooth: true,
                        type: 'line',
                        symbolSize: 1,
                        symbol: 'none',
                        data: data.topTen,
                        lineStyle: {
                            type: "solid",
                            width: 1
                        }
                    },
                    {
                        name: '前20',
                        smooth: true,
                        type: 'line',
                        symbolSize: 1,
                        symbol: 'none',
                        data: data.topTwenty,
                        lineStyle: {
                            type: "solid",
                            width: 1
                        }
                    },
                    {
                        name: '前30',
                        smooth: true,
                        type: 'line',
                        symbolSize: 1,
                        symbol: 'none',
                        data: data.topThirty,
                        lineStyle: {
                            type: "solid",
                            width: 1
                        }
                    },
                    {
                        name: '前40',
                        smooth: true,
                        type: 'line',
                        symbolSize: 1,
                        symbol: 'none',
                        data: data.topForty,
                        lineStyle: {
                            type: "solid",
                            width: 1
                        }
                    },
                    {
                        name: '前50',
                        smooth: true,
                        type: 'line',
                        symbolSize: 1,
                        symbol: 'none',
                        data: data.topFifty,
                        lineStyle: {
                            type: "solid",
                            width: 1
                        }
                    }
                ]
            };
            designationWordTrendCharts.setOption(option);
        }

        function generateQZXTKeywordTrendCharts(domElement, data) {
            if (domElement === undefined) {
                return;
            }
            if (data.date == null) {
                domElement.innerHTML = "<h1 style='text-align: center'> 暂无数据 </h1>";
                return;
            }
            var keywordRecordCharts = echarts.init(domElement);
            var colors = ['#228B22', '#0000FF', '#FF6100', '#FF0000', '#d14a61', '#675bba'];
            var option = {
                color: colors,
                title: {
                    text: '排名 - 操作词数图表',
                    textStyle: {
                        color: '#999',
                        fontFamily: "Arial",
                        fontWeight: 400,
                        fontSize: 12
                    },
                    x: 'center',
                    bottom: -1
                },
                tooltip: {
                    trigger: 'axis',
                    confine: true,
                    position: function (point, params, dom, rect, size) {
                        return [point[0] + 20, '-15%'];
                    }
                },
                grid: {
                    x: 6,
                    y: 15,
                    x2: 6,
                    y2: 4,
                    containLabel: true
                },
                xAxis: [
                    {
                        show: false,
                        type: 'category',
                        axisLine: {
                            show: false,
                            lineStyle: {
                                color: '#404A59'
                            }
                        },
                        axisTick: {
                            show: false
                        },
                        boundaryGap: true,
                        data: data.date
                    }
                ],
                yAxis: [
                    {
                        show: true,
                        type: 'value',
                        name: '站点操作词数',
                        position: 'right',
                        axisLine: {
                            show: false,
                            lineStyle: {
                                color: '#404A59'
                            }
                        },
                        splitLine: {
                            show: true,
                            lineStyle: {
                                color: '#DCDCDC',
                                width: 1,
                                type: 'solid'
                            }
                        },
                        axisTick: {
                            show: false
                        },
                        axisLabel: {
                            fontStyle: 'italic',
                            textStyle: {
                                color: '#000'
                            }
                        }
                    },
                    {
                        show: true,
                        type: 'value',
                        name: 'Top排名词数',
                        position: 'left',
                        axisLine: {
                            show: false,
                            lineStyle: {
                                color: '#404A59'
                            }
                        },
                        splitLine: {
                            show: true,
                            lineStyle: {
                                color: '#DCDCDC',
                                width: 1,
                                type: 'solid'
                            }
                        },
                        axisTick: {
                            show: false
                        },
                        axisLabel: {
                            fontStyle: 'italic',
                            textStyle: {
                                color: '#000'
                            }
                        }
                    }
                ],
                series: [
                    {
                        name: '操作词数',
                        type: 'line',
                        smooth: true,
                        symbolSize: 3,
                        symbol: 'none',
                        lineStyle: {
                            normal: {
                                width: 3
                            }
                        },
                        yAxisIndex: 0,
                        data: data.baiduRecord
                    },
                    {
                        name: '前10',
                        type: 'line',
                        yAxisIndex: 1,
                        data: data.topTen,
                        smooth: true,
                        symbolSize: 1,
                        symbol: 'none',
                        lineStyle: {
                            type: "solid",
                            width: 1
                        }
                    },
                    {
                        name: '前20',
                        type: 'line',
                        yAxisIndex: 1,
                        data: data.topTwenty,
                        smooth: true,
                        symbolSize: 1,
                        symbol: 'none',
                        lineStyle: {
                            type: "solid",
                            width: 1
                        }
                    },
                    {
                        name: '前30',
                        type: 'line',
                        yAxisIndex: 1,
                        data: data.topThirty,
                        smooth: true,
                        symbolSize: 1,
                        symbol: 'none',
                        lineStyle: {
                            type: "solid",
                            width: 1
                        }
                    },
                    {
                        name: '前40',
                        type: 'line',
                        yAxisIndex: 1,
                        data: data.topForty,
                        smooth: true,
                        symbolSize: 1,
                        symbol: 'none',
                        lineStyle: {
                            type: "solid",
                            width: 1
                        }
                    },
                    {
                        name: '前50',
                        type: 'line',
                        yAxisIndex: 1,
                        data: data.topFifty,
                        smooth: true,
                        symbolSize: 1,
                        symbol: 'none',
                        lineStyle: {
                            type: "solid",
                            width: 1
                        }
                    }
                ]
            };
            keywordRecordCharts.setOption(option);
        }

        function initQZSettingKeywordCount(div, customerKeywordCount, categoryTagNames, operationCombineName) {
            if (customerKeywordCount) {
                div.parent().find(".other-rank .line1").find("div[name='activeCount'] a").text(customerKeywordCount["activeCount"]);
                div.parent().find(".other-rank .line1").find("div[name='stopCount'] a").text(customerKeywordCount["stopCount"]);
            }
            if (categoryTagNames) {
                if (categoryTagNames.length > 0) {
                    var tagNameStr = "";
                    var span = $(div).parent().parent().parent().find(".header span.tagNames");
                    $.each(categoryTagNames, function (idx, val) {
                        tagNameStr += val + ",";
                    });
                    $(span).find("a.tagNameStr").html(tagNameStr.substring(0, tagNameStr.length - 1));
                    $(span).find("a.tagNameStr").attr('title', tagNameStr.substring(0, tagNameStr.length - 1))
                }
            }
            if (operationCombineName) {
                div.find("#operationCombine span").prop("title", operationCombineName);
                div.find("#operationCombine span a").text(operationCombineName);
            }
        }


        function toDateFormat(time) {
            return time.getFullYear() + "-" +
                (time.getMonth() + 1) + "-" +
                time.getDate();
        }

        table.on('checkbox(tableFilter)', function (obj) {

        });

        table.on('toolbar(tableFilter)', function (obj) {
            var data = obj.data, event = obj.event;
            switch (event) {
                case 'addQz':
                    addQZSetting();
                    break;
                case 'updFZTags':
                    openUpdFZTags();
                    break;
                case 'batchDeleteQZSetting':
                    batchDeleteQZSetting();
                    break;
                case 'batchUpdateQZSettingUpdateStatus':
                    batchUpdateQZSettingUpdateStatus();
                    break;
                case 'batchUpdateQZSettingFrom':
                    batchUpdateQZSettingFrom();
                    break;
                case 'batchUpdateRenewalStatusToNormal':
                    saveChargeStatus(1);
                    break;
                case 'batchUpdateRenewalStatusToSuspend':
                    saveChargeStatus(0);
                    break;
                case 'batchUpdateRenewalStatusToSoldOut':
                    saveChargeStatus(3);
                    break;
                case 'batchUpdateRenewalStatusToOther':
                    batchUpdateRenewalStatus(4);
                    break;
                default:
                    break;
            }
        });

        function saveChargeStatus(renewalStatus) {
            let checkStatus = table.checkStatus('qzSettingTable').data;
            if (checkStatus.length === 0) {
                common.showFailMsg('请选择需要收费的站点');
                return;
            }

            let chargeMoney = '<div class="layui-form-item">\n                                <label style="width: 120px" class="layui-form-label">收费金额：</label>\n                                <div style="margin-left: 120px" class="layui-input-block">\n                                  <input type="text" id="money"  onkeyup="value=value.replace(/^(00+)|^(0\\d+)|[^\\d]+/g,\'\')" autocomplete="off" placeholder="选填" class="layui-input">\n                                </div>\n                              </div>';

            let chargeStatus = '<div class="layui-form-item">\n                                <label style="width: 120px;line-height: 22px" class="layui-form-label">客户满意度：</label>\n                                <div style="margin-left: 120px;display: flex" class="layui-input-block">\n                                    <div style="flex: 1">\n                                        <ul class="clean-float">\n                                             <li style="padding-left: 0" onmouseover="over(this)" onmouseout="out(this)" onclick="clickXx(this)">&#9733;</li>\n                                             <li onmouseover="over(this)" onmouseout="out(this)" onclick="clickXx(this)">&#9733;</li>\n                                             <li onmouseover="over(this)" onmouseout="out(this)" onclick="clickXx(this)">&#9733;</li>\n                                             <li onmouseover="over(this)" onmouseout="out(this)" onclick="clickXx(this)">&#9733;</li>\n                                             <li onmouseover="over(this)" onmouseout="out(this)" onclick="clickXx(this)">&#9733;</li>\n                                        </ul>\n                                    </div>\n                                    <div id="chargeStatus" style="flex: 2;font-size: 15px;line-height: 42px;height: 40px;letter-spacing: 1px"></div>\n                                </div>\n                              </div>\n                               <div class="layui-form-item layui-form-text">';

            let chargeStatusFooter = '<div style="margin-left: 120px;" class="layui-input-block">\n                                  <textarea style="min-height: 80px" id="customerMsg" placeholder="请输入内容" class="layui-textarea"></textarea>\n                                </div>\n                              </div></div>';

            switch (renewalStatus) {
                case 1:
                    chargeStatus = '<div class="charge-status">' + chargeMoney + chargeStatus
                        + '<label style="width: 120px" class="layui-form-label">客户评价：</label>' + chargeStatusFooter;
                    break;
                case 0:
                    chargeStatus = '<div class="charge-status">' + chargeStatus
                        + '<label style="width: 120px" class="layui-form-label">客户评价：</label>' + chargeStatusFooter;
                    break;
                case 3:
                    chargeStatus = '<div class="charge-status">' + chargeStatus
                        + '<label style="width: 120px" class="layui-form-label">下架原因：</label>' + chargeStatusFooter;
                    break;
                default:
                    break;
            }
            layer.open({
                type: 1,
                title: '客户满意度调查',
                content: chargeStatus,
                shadeClose: true,
                resize: false,
                area: '600px',
                offset:'40px',
                btn: ['确认', '取消'],
                yes: function (index) {
                    let p_d = {};
                    p_d.chargeStatus = renewalStatus;
                    let l = [];
                    for (let i = 0; i < checkStatus.length; i++) {
                        l[i] = checkStatus[i].uuid;
                    }
                    p_d.qzSettingUUids = l;
                    let money = document.getElementById('money');
                    let satisfaction = document.getElementsByClassName('hs');
                    let customerMsg = document.getElementById('customerMsg');
                    if (money) {
                        p_d.money = money.value.trim();
                    }
                    if (satisfaction.length !== 0) {
                        p_d.satisfaction = satisfaction.length;
                    } else {
                        p_d.satisfaction = 1;
                    }
                    if (customerMsg && customerMsg.value.trim()) {
                        p_d.customerMsg = customerMsg.value.trim();
                    }else {
                        common.showFailMsg("请输入评价或原因。");
                        return;
                    }
                    $.ajax({
                        url: '/internal/qzchargestatus/saveQZChargeStatus',
                        type: 'post',
                        data: JSON.stringify(p_d),
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json'
                        }, success: function (res) {
                            if (res.code === 200) {
                                layer.close(index);
                                chargeStatusValue = 0;
                                chargeStatusText = '';
                                common.showSuccessMsg('修改成功', active['reload'].call(this));
                            } else {
                                common.showFailMsg('修改失败');
                            }
                        }
                    });
                }, btn2: function (index) {
                    chargeStatusValue = 0;
                    chargeStatusText = '';
                    layer.close(index);
                }
            });
        }

        let chargeStatusText = '';
        let chargeStatusValue = 0;
        window.over = function (e) {
            if (chargeStatusValue !== 0) {
                let s = e.parentElement.children;
                for (let i = 0; i < 5; i++) {
                    s[i].classList.remove('hs');
                }
            }
            let i = 0;
            while (e) {
                e.classList.add('hs');
                e = e.previousElementSibling;
                i++;
            }
            let c = document.getElementById('chargeStatus');
            switch (i) {
                case 5:
                    c.innerHTML = '<span style="color: green">非常满意</span>';
                    break;
                case 4:
                    c.innerHTML = '<span style="color: #006529">满意</span>';
                    break;
                case 3:
                    c.innerHTML = '<span style="color: #628000">一般</span>';
                    break;
                case 2:
                    c.innerHTML = '<span style="color: #e95500">差</span>';
                    break;
                default:
                    c.innerHTML = '<span style="color: #ff0000">非常差</span>';
                    break;
            }
        };

        window.out = function (e) {
            let s = e.parentElement.children;
            while (e) {
                e.classList.remove('hs');
                e = e.previousElementSibling;
            }
            if (chargeStatusValue !== 0) {
                for (let i = 0; i < chargeStatusValue; i++) {
                    s[i].classList.add('hs');
                }
            }
            document.getElementById('chargeStatus').innerHTML = chargeStatusText;
        };

        window.clickXx = function (e) {
            let j = 0;
            while (e) {
                e = e.previousElementSibling;
                j++;
            }
            switch (j) {
                case 5:
                    chargeStatusText = '<span style="color: green">非常满意</span>';
                    break;
                case 4:
                    chargeStatusText = '<span style="color: #006529">满意</span>';
                    break;
                case 3:
                    chargeStatusText = '<span style="color: #628000">一般</span>';
                    break;
                case 2:
                    chargeStatusText = '<span style="color: #e95500">差</span>';
                    break;
                default:
                    chargeStatusText = '<span style="color: #ff0000">非常差</span>';
                    break;
            }
            chargeStatusValue = j;
        };

        window.showChargeStatus = function(uuid){
            okLayer.open("其他 / 前往全站设置信息 / 收费状态记录", "/internal/qzchargestatus/toQzChargeStatus", "60%", "70%",
                function (layero) {
                    window[layero.find("iframe")[0]["name"]].initForm(uuid);
                }, function () {
                    /*if (sign) {
                        active['reload'].call(this);
                        sign = false;
                    }*/
                },'40px');
        };

        let tips_ = null;

        window.showTip = function (e, uuid) {
            if (uuid !== null && uuid !== "null" && uuid !== "" && uuid !== "0" && uuid !== 0) {
                $.ajax({
                    url: '/internal/qzchargestatus/getOneQzChargeStatus/' + uuid,
                    type: 'get',
                    dataType: 'json',
                    success: function (res) {
                        if (res.code === 200) {
                            let bz = '';
                            let msg = '<span>上次更新时间：';
                            msg += new Date(res.data.createTime).format('yyyy年MM月dd日');
                            msg += '</span><br>续费状态：';
                            switch (res.data.chargeStatus) {
                                case 1:
                                    msg += '续费';
                                    bz = '<span>客户评价：';
                                    break;
                                case 0:
                                    msg += '暂停续费';
                                    bz = '<span>客户评价：';
                                    break;
                                case 3:
                                    msg += '下架';
                                    bz = '<span>下架原因：';
                                    break;
                                default:
                                    msg += '暂无';
                                    break;
                            }
                            if(res.data.chargeMoney !== 0){
                                msg += '</span><br>收费金额：';
                                msg += res.data.chargeMoney;
                            }
                            msg += '<span><br>客户满意度：';
                            switch (res.data.customerSatisfaction) {
                                case 4:
                                    msg += '满意';
                                    break;
                                case 3:
                                    msg += '一般';
                                    break;
                                case 5:
                                    msg += '非常满意';
                                    break;
                                case 2:
                                    msg += '差';
                                    break;
                                case 1:
                                    msg += '非常差';
                                    break;
                                default:
                                    msg += '一般';
                                    break;
                            }
                            if (res.data.chargeStatusMsg !== ''){
                                msg += "</span><br>" + bz;
                                msg += res.data.chargeStatusMsg + "</span>";
                            }
                            tips_ = layer.tips(msg, e, {tips: 1, time: 20000, area:'auto', maxWidth: '400'});
                        } else {
                            common.showFailMsg('数据获取失败');
                        }
                    }
                });
            } else {
                tips_ = layer.tips('暂无数据~', e, {tips: 1, time:0});
            }
        };

        window.closeTip = function(){
            if (tips_!==null){
                layer.close(tips_);
            }
        };

        let tableTips_ = null;

        window.showTableTip = function (e, uuid) {
            if (uuid !== null && uuid !== "null" && uuid !== "" && uuid !== "0" && uuid !== 0) {
                var postData = {};
                postData.uuid = uuid;
                postData.terminalType = document.getElementById('terminalType').value;
                $.ajax({
                    url: '/internal/qzsetting/getChargeRuleMsg',
                    type: 'POST',
                    data: JSON.stringify(postData),
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    success: function (res) {
                        if (res.code === 200) {
                            let arr = res.data;
                            let herder = '爱站';
                            switch (res.data[0].standardSpecies) {
                                case 'aiZhan':
                                    herder = '爱站';
                                    break;
                                case '5118':
                                    herder = '5118';
                                    break;
                                case 'designationWord':
                                    herder = '指定词';
                                    break;
                                default:
                                    herder = '爱站';
                                    break;
                            }
                            let html = '<div><table border="0" width="100%">' +
                                '<tbody><tr class="my-bg"><td colspan="5" class="my-header-title my-header-btn">' +
                                '<div style="max-width: none" class="my-label my-padding">' + herder +
                                '</div></td></tr><tr class="my-bg">' +
                                '<td class="my-header-title" style="min-width: 60px">' +
                                '<div class="my-label my-padding">序号</div>' +
                                '</td><td class="my-header-title" style="min-width: 80px">' +
                                '<div class="my-label my-padding">起始词量</div>' +
                                '</td><td class="my-header-title" style="min-width: 80px">' +
                                '<div class="my-label my-padding">终止词量</div>' +
                                '</td><td class="my-header-title my-header-btn" style="min-width: 60px">' +
                                '<div class="my-label my-padding">价格</div>' +
                                '</td></tr>';
                            for (let i = 0; i < arr.length; i++) {
                                html += '<tr>\n                                    <td class="my-left">\n                                        <div class="my-label my-padding">';
                                html += i + 1;
                                html += '</div>\n                                    </td>\n                                    <td class="my-left">\n                                        <div class="my-label my-padding">';
                                html += arr[i].startKeywordCount ? arr[i].startKeywordCount : '';
                                html += '</div>\n                                    </td>\n                                    <td class="my-left">\n                                        <div class="my-label my-padding">';
                                html += arr[i].endKeywordCount ? arr[i].endKeywordCount : '';
                                html += '</div>\n                                    </td>\n                                    <td class="my-left my-header-btn">\n                                        <div class="my-label my-padding">';
                                html += arr[i].amount ? arr[i].amount : '';
                                html += '</div>\n                                    </td></tr>';
                            }
                            html += noteBookHtmlFooter;
                            tableTips_ = layer.tips(html, e, {
                                tips: 1, time: 20000, area: 'auto', maxWidth: '800',
                                success: function (e) {
                                    e[0].classList.add('table-tips');
                                    let top = e[0].style.top;
                                    top = parseFloat(top.substring(0, top.length - 2));
                                    e[0].style.top = (top + 40) + 'px';
                                }
                            });
                        } else if (res.code === 300) {
                            common.showFailMsg('暂无数据');
                        } else {
                            common.showFailMsg('数据获取失败');
                        }

                    }
                });
            } else {
                tableTips_ = layer.tips('暂无数据~', e, {tips: 1, time:0});
            }
        };

        window.closeTableTip = function(){
            if (tableTips_!==null){
                layer.close(tableTips_);
            }
        };

        window.showChargeLog = function (uuid) {
            $.ajax({
                url: '/internal/qzchargelog/qzChargesLogsList/' + uuid,
                type: 'GET',
                dataType: 'json',
                success: function (res) {
                    if (res.code === 200) {
                        let arr = res.data;
                        let html = chargeRecordHtml;
                        let date = new Date();
                        for (let i = 0; i < arr.length; i++) {
                            html += '<tr>\n                                    <td class="my-left">\n                                        <div class="my-label my-padding">';
                            html += new Date(arr[i].actualChargeDate).format('yyyy-MM-dd');
                            html += '</div>\n                                    </td>\n                                    <td class="my-left">\n                                        <div class="my-label my-padding">';
                            html += arr[i].operationType;
                            html += '</div>\n                                    </td>\n                                    <td class="my-left">\n                                        <div class="my-label my-padding">';
                            html += arr[i].actualAmount;
                            html += '</div>\n                                    </td>\n                                    <td class="my-left">\n                                        <div class="my-label my-padding">';
                            html += arr[i].userName;
                            html += '</div>\n                                    </td>\n                                    <td class="my-left my-bottom">\n                                        <div\n                                            class="my-label my-padding">';
                            html += new Date(arr[i].createTime).format('yyyy-MM-dd hh:mm:ss');
                            html += '</div>\n                                    </td>\n                                </tr>';
                        }
                        html += noteBookHtmlFooter;
                        layer.open({
                            type: 1,
                            title: '收费记录',
                            content: html,
                            shadeClose: true,
                            resize: false,
                            area: '700px',
                            offset:'40px'
                        });
                    } else if (res.code === 300) {
                        common.showFailMsg('暂无数据');
                    } else {
                        common.showFailMsg('数据获取失败');
                    }
                },
                error: function () {
                    common.showFailMsg('网络异常请稍后再试');
                }
            });
        };

        window.showOperation = function (e) {
            let this_ = $(e);
            this_.find('#operation').css("display","block");
        };

        window.hideOperation = function (e) {
            let this_ = $(e);
            this_.find('#operation').css("display","none");
        };

        function openUpdFZTags() {
            let checkStatus = table.checkStatus('qzSettingTable').data;
            if (checkStatus.length === 0) {
                common.showFailMsg('请选择需要修改站点');
                return false;
            }
            layer.open({
                type: 1,
                title: '修改分组标签',
                content: updFZTagsHtml,
                shadeClose: true,
                resize: false,
                area: '420px',
                offset:'40px',
                btn: ['确认', '取消'],
                yes: function (index) {
                    let v = document.getElementById('tagNames').value.trim();
                    if (!/^[\u4e00-\u9fa50-9a-zA-Z,]*$/.test(v)) {
                        common.showFailMsg('请输入符合规则的标签数据');
                        return false;
                    }
                    let d = {}, tags = [], ids = [], tagNames = v.split(',');
                    tagNames = tagNames.filter(function (val, index) {
                        return tagNames.indexOf(val) === index && val !== "";
                    });
                    if (v.indexOf("暂无") > -1 && tagNames.length === 0 && v !== "") {
                        common.showFailMsg('请输入有意义的数据');
                        return false;
                    }
                    for (let item in tagNames) {
                        let a = {};
                        a.tagName = tagNames[item];
                        tags.push(a);
                    }
                    for (let i = 0; i < checkStatus.length; i++) {
                        ids.push(checkStatus[i].uuid + "");
                    }
                    d.targetQZCategoryTags = tags;
                    d.uuids = ids;
                    if (v) {
                        updFzTags(d, index);
                    } else {
                        layer.confirm('确认修改为空值吗？', {offset: '120px'}, function (__index) {
                            updFzTags(d, index);
                            layer.close(__index);
                        });
                    }
                }, btn2: function (index) {
                    layer.close(index);
                }, cancel: function () {
                }
            });
        }

        function updFzTags(d,index) {
            $.ajax({
                url: '/internal/qzsetting/updQzCategoryTags',
                type: 'post',
                data: JSON.stringify(d),
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                success: function (res) {
                    if (res.code === 200) {
                        layer.close(index);
                        common.showSuccessMsg('修改成功', active['reload'].call(this));
                    } else {
                        common.showFailMsg('修改失败');
                    }
                }
            });
        }

        function addQZSetting() {
            okLayer.open("其他 / 前往全站设置信息 / 添加", "/internal/qzsetting/toQZSettingAdd", "90%", "90%",
                function (layero) {
                    window[layero.find("iframe")[0]["name"]].initForm2('${isSEOSales}');
                }, function () {
                    if (sign) {
                        active['reload'].call(this);
                        sign = false;
                    }
                },'40px');
        }

        let chargeRecordHtml = '<div style="padding: 10px;">\n                            <table border="0" width="100%">\n                                <tbody>\n                                <tr class="my-bg">\n                                    <td class="my-header-title" style="min-width: 120px">\n                                        <div class="my-label my-padding">\n                                            收费时间\n                                        </div>\n                                    </td>\n                                    <td class="my-header-title" style="min-width: 80px">\n                                        <div class="my-label my-padding">\n                                            终端类型\n                                        </div>\n                                    </td>\n                                    <td class="my-header-title" style="min-width: 80px">\n                                        <div class="my-label my-padding">\n                                            收费金额\n                                        </div>\n                                    </td>\n                                    <td class="my-header-title" style="min-width: 80px">\n                                        <div class="my-label my-padding">\n                                            收费人员\n                                        </div>\n                                    </td>\n                                    <td class="my-header-btn"  style="min-width: 240px">\n                                        <div\n                                            class="my-label my-padding">\n                                            创建时间\n                                        </div>\n                                    </td>\n                                </tr>';

        let updFZTagsHtml = '<div style="width: 100%;margin-top: 10px;text-align: center">\n                <div class="layui-inline" style="width: 60px;line-height: 34px;text-align: center">新标签：</div>\n                <div class="layui-inline">\n                    <div class="layui-input-inline" style="width: 300px">\n                        <input style="height: 34px" type="text" id="tagNames" placeholder="每个词用逗号隔开例如:阿卡索,MBA"\n                        autocomplete="off" class="layui-input">\n                    </div>\n                </div>\n            </div>';

        let oneRowI = '<tr>\n                            <td class="my-left" colspan="4">\n                                <div class="my-label" style="max-width: none">\n                                     <input type="text" class="layui-input my-input"\n                                     placeholder="请在此输入你想要记录的内容"\n                                     style="height: 36px;padding-right: 10px">\n                                </div>\n                            </td>\n                            <td class="my-left my-bottom">\n                                <div class="my-label my-btn">\n                                <button type="button" onclick="commitNoteBook(this)"\n                                    class="layui-btn layui-btn-xs">\n                                保存\n                                </button>\n                                </div>\n                             </td>\n                             </tr>';

        /**
         * 修改
         */
        window.showSettingDialog = function (uuid) {
            okLayer.open("其他 / 前往全站设置信息 / 修改", "/internal/qzsetting/toQZSettingAdd", "90%",
                "90%", function (layero) {
                    window[layero.find("iframe")[0]["name"]].initForm(uuid);
                }, function () {
                    if (sign) {
                        sign = false;
                    }
                },'40px')
        };

        /**
         * 收费
         */
        window.showChargeDialog = function (uuid, contactPearson, domain, renewalStatus) {
            okLayer.open("其他 / 前往全站设置信息 / 收费", "/internal/qzsetting/toQZSettingCharge", "60%",
                "70%", function (layero) {
                    window[layero.find("iframe")[0]["name"]].initForm(
                        {
                            uuid: uuid,
                            qzSettingCustomer: contactPearson,
                            qzSettingDomain: domain,
                            renewalStatus: renewalStatus
                        });
                }, function () {
                    if (sign) {
                        active['reload'].call(this);
                        sign = false;
                    }
                },'40px');
        };

        window.commitNoteBook = function (e) {
            let this_ = e.parentElement.parentElement;
            let td_l = this_.parentElement.children;
            let d = {};
            if (td_l.length > 2) {
                this_ = this_.previousElementSibling.previousElementSibling.children[0].children;
                d.uuid = this_[0].value;
                d.content = this_[1].value.trim();
            } else {
                d.content = this_.previousElementSibling.children[0].children[0].value.trim();
            }
            if (!d.content){
                common.showFailMsg("请填写内容");
                return;
            }
            d.customerUuid = document.getElementById('notBookCustomerUuid').value;
            d.terminalType = document.getElementById('terminalType').value;
            $.ajax({
                url: '/internal/notebook/saveUserNoteBook',
                type: 'POST',
                headers: {
                    "Accept": 'application/json',
                    "Content-Type": 'application/json'
                },
                data: JSON.stringify(d),
                success: function (res) {
                    if (res.code === 200) {
                        refreshNotebook(d.customerUuid);
                    } else {
                        common.showFailMsg('数据获取失败');
                    }
                },
                error: function () {
                    common.showFailMsg('网络异常请稍后再试');
                }
            });
        };

        window.appendTable = function () {
            if (noteAddRow) {
                let noteBookTbody = document.getElementById('noteBookTbody');
                noteBookTbody.innerHTML += oneRowI;
                noteAddRow = false;
            }
        };

        window.updNoteBook = function (e) {
            let this_ = e.parentElement.parentElement.parentElement;
            let td_l = this_.children;
            let index = td_l[0].children[0].innerText;
            let name = td_l[1].children[0].innerText;
            let uuid = td_l[2].children[0].children[0].value;
            let old = td_l[2].children[0].innerText;
            let date = td_l[3].children[0].innerText;
            let html = '<td class="my-left">\n' +
                '<div class="my-label my-padding">';
            html += index;
            html += '</div>\n' +
                '</td>\n' +
                '<td class="my-left">\n' +
                '<div class="my-label my-padding">';
            html += name;
            html += '</div>\n' +
                '</td>\n' +
                '<td class="my-left">\n' +
                '<div class="my-label">\n' +
                '<input type="hidden" value="';
            html += uuid;
            html += '">\n' +
                '<input type="text" class="layui-input my-input" placeholder="请在此输入" style="height: 36px; width:330px" value="';
            html += old;
            html += '">\n' +
                '</div>\n' +
                '</td>\n' +
                '<td class="my-left">\n' +
                '<div class="my-label my-padding">';
            html += date;
            html += '</div>\n'
                + '</td>\n'
                + '<td class="my-left my-bottom">\n'
                + '<div class="my-label my-btn">\n'
                + '<button type="button" onclick="commitNoteBook(this)"\n'
                + 'class="layui-btn layui-btn-xs"> 保存\n'
                + '</button>\n'
                + '</div>\n'
                + '</td>';
            this_.innerHTML = html;
        };

        window.refreshNotebook = function (uuid) {
            noteAddRow = true;
            if (!uuid) {
                uuid = document.getElementById('notBookCustomerUuid').value;
            }
            showData(uuid, function (noteBookHtml) {
                let noteBookBody = document.getElementById('noteBookBody').parentElement;
                noteBookBody.innerHTML = noteBookHtml;
                document.getElementById('notBookCustomerUuid').value = uuid;
            });
        };

        /**
         * 运营记录 原记事本
         */
        window.openNoteBookDialog = function (uuid) {
            noteAddRow = true;
            showData(uuid, function (noteBookHtml) {
                layer.open({
                    type: 1,
                    title: '运营记录',
                    content: noteBookHtml,
                    shadeClose: true,
                    resize: false,
                    area: '700px',
                    offset:'40px',
                    success: function () {
                        document.getElementById('notBookCustomerUuid').value = uuid;
                    }
                });
            });
        };

        let noteBookHtmlFooter = '</tbody></table></div>';

        function showData(uuid, call) {
            let noteBookHtml = '<div style="padding: 10px;" id="noteBookBody">\n' +
                '<table border="0" width="100%">\n' +
                '<tbody id="noteBookTbody">\n' +
                '<tr class="my-bg">\n' +
                '<td colspan="3" class="my-header-title">\n' +
                '<input type="hidden" id="notBookCustomerUuid" value>\n' +
                '<div id="phoneTitle" style="max-width: none" class="my-label my-padding">\n' +
                '运 营 记 录\n' +
                '</div>\n' +
                '</td>\n' +
                '<td class="my-header-title">\n' +
                '<div class="my-label">\n' +
                '<button onclick="appendTable()" type="button" style="padding: 0 36px" class="layui-btn layui-btn-xs">\n' +
                '增加\n' +
                '</button>\n' +
                '</div>\n' +
                '</td>\n' +
                '<td class="my-header-btn">\n' +
                '<div class="my-label">\n' +
                '<button onclick="refreshNotebook()" type="button" style="padding: 0 20px" class="layui-btn layui-btn-xs">\n' +
                '刷新\n' +
                '</button>\n' +
                '</div>\n' +
                '</td>\n' +
                '</tr>\n' +
                '<tr class="my-bg">\n' +
                '<td class="my-left" style="min-width: 70px">\n' +
                '<div class="my-label my-padding">\n' +
                '序号\n' +
                '</div>\n' +
                '</td>\n' +
                '<td class="my-left">\n' +
                '<div class="my-label my-padding">\n' +
                '记录者\n' +
                '</div>\n' +
                '</td>\n' +
                '<td class="my-left">\n' +
                '<div class="my-label my-padding">\n' +
                '内容\n' +
                '</div>\n' +
                '</td>\n' +
                '<td class="my-left" style="min-width: 120px">\n' +
                '<div class="my-label my-padding">\n' +
                '日期\n' +
                '</div>\n' +
                '</td>\n' +
                '<td class="my-left my-bottom">\n' +
                '<div class="my-label my-padding">\n' +
                '操作\n' +
                '</div>\n' +
                '</td>\n' +
                '</tr>';
            let d = {};
            d.customerUuid = uuid;
            d.searchAll = 0;
            d.terminalType = document.getElementById('terminalType').value;
            $.ajax({
                url: '/internal/notebook/getUserNoteBooks',
                type: 'POST',
                headers: {
                    "Accept": 'application/json',
                    "Content-Type": 'application/json'
                },
                data: JSON.stringify(d),
                success: function (res) {
                    if (res.code === 200) {
                        if (res.data.length === 0) {
                            noteBookHtml += oneRowI;
                            noteAddRow = false;
                        } else {
                            for (let i = 0; i < res.data.length; i++) {
                                noteBookHtml += '<tr>\n' +
                                    '<td class="my-left">\n' +
                                    '<div class="my-label my-padding">';
                                noteBookHtml += i + 1;
                                noteBookHtml += '</div>\n                                    </td>\n                                    <td class="my-left">\n                                    <div class="my-label my-padding">';
                                noteBookHtml += res.data[i].notesPerson;
                                noteBookHtml += '</div>\n                                    </td>\n                                    <td class="my-left">\n                                    <div class="my-label my-padding" style="text-align:left;">\n                                    <input type="hidden" value="';
                                noteBookHtml += res.data[i].uuid;
                                noteBookHtml += '">';
                                noteBookHtml += res.data[i].content;
                                noteBookHtml += '</div>\n                                    </td>\n                                    <td class="my-left">\n                                    <div class="my-label my-padding">';
                                noteBookHtml += new Date(res.data[i].createTime).format(
                                    'yyyy-MM-dd');
                                noteBookHtml += '</div>\n                                </td>\n                                <td class="my-left my-bottom">\n                                    <div class="my-label my-btn">\n                                    <button type="button" onclick="updNoteBook(this)"\n                                        class="layui-btn layui-btn-xs layui-btn-danger">\n                                    修改\n                                    </button>\n                                    </div>\n                                    </td>\n                                    </tr>';
                            }
                        }
                        noteBookHtml += noteBookHtmlFooter;
                        call(noteBookHtml);
                    } else {
                        common.showFailMsg('数据获取失败');
                    }
                },
                error: function () {
                    common.showFailMsg('网络异常请稍后再试');
                }
            });
        }

        /**
         *  全站设置排除词
         */
        window.showExcludeCustomerKeywordDialog = function (uuid, customerUuid, domain, pcGroup,
            phoneGroup) {
            let terminalType = $("#terminalType").val();
            let optimizeGroupName = phoneGroup;
            if (terminalType === 'PC') {
                optimizeGroupName = pcGroup;
            }
            okLayer.open("其他 / 前往全站设置信息 / 排除关键字", "/internal/qzsetting/toExcludeCustomerKeyword",
                "60%", "70%", function (layero) {
                    window[layero.find("iframe")[0]["name"]].initForm({
                        qzSettingUuid: uuid,
                        customerUuid: customerUuid,
                        domain: domain,
                        terminalType: terminalType,
                        optimizeGroupName: optimizeGroupName
                    });
                }, function () {

                },'40px')
        };

        /**
         * 修改选中站点优化组关联的操作组合
         */
        form.on('select(operationCombineFilter)', function (data) {
            let checkStatus = table.checkStatus('qzSettingTable');
            if (checkStatus.data.length === 0) {
                $("#update_qz_operation_combine").val('');
                common.showFailMsg('请选择要修改优化组关联的操作组合的站点');
                return false;
            }
            layer.confirm("确定要修改所选站点优化组关联的操作组合吗？", {icon: 3, offset:'120px',title: '修改操作组合'}, function (index) {
                let groupNameArr = [];
                $.each(checkStatus.data, function (i, v) {
                    if (v.pcGroup !== null) {
                        groupNameArr.push(v.pcGroup);
                    } else {
                        groupNameArr.push(v.phoneGroup);
                    }
                });

                let postData = {};
                postData.operationCombineUuid = (data.value === 'null' || data.value === '') ? null
                    : data.value;
                postData.groupNames = groupNameArr;
                $.ajax({
                    url: '/internal/group/updateGroupOperationCombineUuid',
                    type: 'POST',
                    data: JSON.stringify(postData),
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    success: function (result) {
                        if (result.code === 200) {
                            common.showSuccessMsg('操作成功', active['reload'].call(this));
                        } else {
                            common.showFailMsg('操作失败');
                        }
                    },
                    error: function () {
                        common.showFailMsg('网络异常请稍后再试');
                    }
                });
                layer.close(index);
            });
        });

        /**
         * 全站添加关键字
         */
        window.showAddKeywordDialog = function (uuid, customerUuid, domain, bearPawNumber, searchEngine, type, pcGroup, phoneGroup) {
            let terminalType = $("#terminalType").val();
            let optimizeGroupName = phoneGroup;
            if (terminalType === 'PC') {
                optimizeGroupName = pcGroup;
            }
            okLayer.open("其他 / 全站设置信息 / 添加关键字", "/internal/qzsetting/toAddCustomerKeyword",
                "60%", "70%", function (layero) {
                    window[layero.find("iframe")[0]["name"]].initForm({
                        qzSettingUuid: uuid,
                        customerUuid: customerUuid,
                        domain: domain,
                        bearPawNumber: bearPawNumber,
                        searchEngine: searchEngine,
                        type: type,
                        terminalType: terminalType,
                        optimizeGroupName: optimizeGroupName
                    });
                }, function () {
                    if (sign) {
                        active['reload'].call(this);
                        sign = false;
                    }
                },'40px'
            );
        };

        /**
         * 删除单个站点
         * @param uuid
         */
        window.delQZSetting = function (uuid) {
            layer.confirm('确认要删除该站点吗', { offset:'120px'}, function (index) {
                $.ajax({
                    url: '/internal/qzsetting/delete2/' + uuid,
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    timeout: 5000,
                    type: 'POST',
                    success: function (result) {
                        if (result.code === 200) {
                            common.showSuccessMsg('操作成功', active['reload'].call(this));
                        } else {
                            common.showFailMsg('操作失败');
                        }
                    },
                    error: function () {
                        common.showFailMsg('网络异常请稍后再试');
                    }
                });
                layer.close(index);
            });
        };

        /**
         * 删除多个站点
         */
        function batchDeleteQZSetting() {
            //获取选中数据
            var checkStatus = table.checkStatus('qzSettingTable')
                , data = checkStatus.data;
            var uuidArr = [];
            $.each(data, function (index, item) {
                uuidArr.push(item.uuid);
            });
            if (uuidArr.length <= 0) {
                common.showFailMsg('请选择要操作的站点');
                return
            }
            layer.confirm("确定要删除所选站点吗", {icon: 3,  offset:'120px',title: '删除所选'}, function (index) {
                var postData = {};
                postData.uuids = uuidArr;
                $.ajax({
                    url: '/internal/qzsetting/deleteQZSettings2',
                    data: JSON.stringify(postData),
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    timeout: 5000,
                    type: 'POST',
                    success: function (result) {
                        if (result.code === 200) {
                            common.showSuccessMsg('操作成功', active['reload'].call(this));
                        } else {
                            common.showFailMsg('操作失败');
                        }
                    },
                    error: function () {
                        common.showFailMsg('网络异常请稍后再试');
                    }
                });
                layer.close(index);
            });
        }

        /**
         * 马上更新 - 批量
         */
        function batchUpdateQZSettingUpdateStatus() {
            //获取选中数据
            let checkStatus = table.checkStatus('qzSettingTable')
                , data = checkStatus.data;
            if (checkStatus.data.length === 0) {
                common.showFailMsg('请选择要操作的站点');
                return;
            }
            layer.confirm("确定要修改所选站点吗", {icon: 3, offset:'120px', title: '修改所选'}, function (index) {
                let uuids = "";
                $.each(data, function (index, item) {
                    uuids += (index === 0 ? "" : ",") + item.uuid;
                });
                var postData = {};
                postData.uuids = uuids;
                $.ajax({
                    url: '/internal/qzsetting/batchUpdateQZSettingUpdateStatus',
                    data: JSON.stringify(postData),
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    timeout: 5000,
                    type: 'POST',
                    success: function (result) {
                        if (result.code === 200) {
                            common.showSuccessMsg('操作成功', active['reload'].call(this));
                        } else {
                            common.showFailMsg('操作失败');
                        }
                    },
                    error: function () {
                        common.showFailMsg('网络异常请稍后再试');
                    }
                });
                layer.close(index);
            });
        }

        /**
         * 修改整站所属
         */
        function batchUpdateQZSettingFrom() {
            //获取选中数据
            let checkStatus = table.checkStatus('qzSettingTable')
                , data = checkStatus.data;
            if (checkStatus.data.length === 0) {
                common.showFailMsg('请选择要操作的站点');
                return;
            }
            if (!toUpdateQZSettingFromData) {
                common.showFailMsg('暂无客户列表');
                return;
            }
            okLayer.open("其他 / 全站信息设置 / 修改整站归属", "/internal/qzsetting/toUpdateQZSettingFrom", "40%", "50%", function (layero) {
                window[layero.find("iframe")[0]["name"]].initForm(toUpdateQZSettingFromData, data);
            }, function () {
                if (sign) {
                    active['reload'].call(this);
                    sign = false;
                }
            }, '40px');
        }

        /**
         * 暂停续费 || 下架整站 - 批量
         */
        function batchUpdateRenewalStatus(renewalStatus) {
            let checkStatus = table.checkStatus('qzSettingTable')
                , data = checkStatus.data;
            if (checkStatus.data.length === 0) {
                common.showFailMsg('请选择要操作的站点');
                return;
            }
            let msg = '未知错误';
            if (renewalStatus === 1) {
                msg = "确认要续费所选整站吗?";
            } else if (renewalStatus === 0) {
                msg = "确认选中的整站要暂停续费吗?";
            } else if (renewalStatus === 3) {
                msg = "确认要下架所选整站吗?";
            } else if (renewalStatus === 4) {
                msg = "确定要将选中整站续费状态改为其他状态吗?";
            }
            layer.confirm(msg, {icon: 3,  offset:'120px',title: '修改所选'}, function (index) {
                let uuids = "";
                $.each(data, function (index, item) {
                    uuids += (index === 0 ? "" : ",") + item.uuid;
                });
                var postData = {};
                postData.uuids = uuids;
                postData.renewalStatus = renewalStatus;
                $.ajax({
                    url: '/internal/qzsetting/batchUpdateRenewalStatus',
                    data: JSON.stringify(postData),
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    },
                    timeout: 5000,
                    type: 'POST',
                    success: function (result) {
                        if (result.code === 200) {
                            common.showSuccessMsg('操作成功', active['reload'].call(this));
                        } else {
                            common.showFailMsg('操作失败');
                        }
                    },
                    error: function () {
                        common.showFailMsg('网络异常请稍后再试');
                    }
                });
                layer.close(index);
            });
        }

        /**
         * 点击操作词数，跳转到关键字列表
         */
        window.searchCustomerKeywords = function (customerUuid, pcGroup, phoneGroup, searchEngine, status) {
            let group = pcGroup === 'null' ? phoneGroup : pcGroup;
            let terminalType = document.getElementById('terminalType').value;
            let url = '/internal/customerKeyword/toKeywordsWithQZ/qz/' + terminalType + '/' + customerUuid + '/' + group + '/' + searchEngine + '/' + status;
            let tit = group + '--关键字列表';
            let id = customerUuid + "-" + (status === 0 ? "暂停" : "激活");
            common.updateOrNewTab(url, tit, id);
        };

        window.toCustomerKeywordFromQZ = function (customerUuid, pcGroup, phoneGroup) {
            let group = pcGroup === 'null' ? phoneGroup : pcGroup;
            let terminalType = document.getElementById('terminalType').value;
            let url = '/internal/customerKeyword/toCustomerKeywordFromQZ/qz/' + terminalType + '/' + customerUuid + '/' + group;
            let tit = group + '--关键字列表';
            let id = customerUuid + '-czcs';
            common.updateOrNewTab(url, tit, id);
        };

        window.editTagNameStr = function (uuid) {
            let old_text = $("a#tagName_" + uuid).text();
            if ("暂无" === old_text) {
                old_text = "";
            }
            layer.open({
                type: 1,
                title: '修改分组标签',
                content: updFZTagsHtml,
                shadeClose: true,
                resize: false,
                area: '420px',
                offset:'40px',
                btn: ['确认', '取消'],
                success: function (layero, index) {
                    document.getElementById('tagNames').value = old_text;
                },
                yes: function (index_0) {
                    let new_text = document.getElementById('tagNames').value;
                    if (!/^[\u4e00-\u9fa50-9a-zA-Z,]*$/.test(new_text)) {
                        common.showFailMsg('请输入符合规则的标签数据');
                        return false;
                    }
                    if (new_text === old_text && old_text !== "") {
                        common.showFailMsg('新分组标签不能与原分组标签相同');
                        return false;
                    }
                    let qzCategoryTags = [], categoryTags = new_text.split(',');
                    categoryTags = categoryTags.filter(function (val, index) {
                        return categoryTags.indexOf(val) === index && val !== "";
                    });
                    if (new_text.indexOf("暂无") > -1 && categoryTags.length === 0 && new_text !== "") {
                        common.showFailMsg('请输入有意义的标签');
                        return false;
                    }
                    for (let item in categoryTags) {
                        let obj = {};
                        obj.tagName = categoryTags[item];
                        qzCategoryTags.push(obj);
                    }
                    let postData = {};
                    postData.qzSettingUuid = uuid;
                    postData.qzCategoryTags = qzCategoryTags;
                    if (new_text){
                        editTagNameOne(postData, categoryTags, uuid, index_0);
                    }else {
                        layer.confirm('确认修改为空值吗？', {offset: '120px'}, function (__index) {
                            editTagNameOne(postData, categoryTags, uuid, index_0);
                            layer.close(__index);
                        });
                    }
                }, btn2: function (index_0) {
                    layer.close(index_0);
                }, cancel: function () {
                }
            })
        };

        function editTagNameOne(postData, categoryTags, uuid, index_0) {
            $.ajax({
                url: "/internal/qzcategory/saveCategoryLabel",
                type: "POST",
                data: JSON.stringify(postData),
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                success: function (res) {
                    if (res.code === 200) {
                        let text = "";
                        for (let item in categoryTags) {
                            text += "," + categoryTags[item];
                        }
                        text = text.substr(1);
                        if (text === "") {
                            text = "暂无";
                        }
                        $("a#tagName_" + uuid).text(text);
                        $("a#tagName_" + uuid).prop("title", text);
                        layer.close(index_0);
                        common.showSuccessMsg('修改成功', active['reload'].call(this));
                    } else {
                        common.showFailMsg('修改失败');
                    }
                }
            });
        }
    });
</script>

<!-- 头工具栏模板 -->
<script type="text/html" id="toolbarTpl">
    <@shiro.hasPermission name="/internal/group/updateGroupOperationCombineUuid">
    <div class="layui-input-inline" style="width: 200px; height: 30px">
        <select id="update_qz_operation_combine" lay-filter="operationCombineFilter" lay-search>
            <option value="">修改所选站点操作组合</option>
        </select>
    </div>
    </@shiro.hasPermission>
    <div class="layui-btn-group">
    <@shiro.hasPermission name="/internal/qzsetting/save">
        <button class="layui-btn layui-btn-sm" lay-event="addQz">
            <i style="position: relative;top: -1px" class="layui-icon">&#xe654;</i>添加整站
        </button>
        <button class="layui-btn layui-btn-sm " lay-event="updFZTags">
            <i class="layui-icon">&#xe642;</i>修改标签
        </button>
    </@shiro.hasPermission>
    <@shiro.hasPermission name="/internal/qzsetting/deleteQZSettings">
    <button class="layui-btn layui-btn-sm layui-btn-danger" lay-event="batchDeleteQZSetting">
        <i style="position: relative;top: -1px" class="layui-icon">&#xe640;</i>删除所选
    </button>
    </@shiro.hasPermission>
    <@shiro.hasPermission name="/internal/qzsetting/updateImmediately">
    <button class="layui-btn layui-btn-sm layui-btn-normal" lay-event="batchUpdateQZSettingUpdateStatus">
        <i style="font-size: 15px !important;" class="layui-icon">&#xe666;</i>马上更新
    </button>
    </@shiro.hasPermission>
    <button class="layui-btn layui-btn-sm" lay-event="batchUpdateQZSettingFrom">
        <i style="font-size: 15px !important;" class="layui-icon">&#xe642;</i>修改整站归属
    </button>
    </div>
    <@shiro.hasRole name="SEOSales">
    <div class="layui-btn-group">
        <button class="layui-btn layui-btn-sm" lay-event="batchUpdateRenewalStatusToNormal">
            <i class="layui-icon">&#x1005;</i>正常续费
        </button>
        <button class="layui-btn layui-btn-sm" lay-event="batchUpdateRenewalStatusToSuspend">
            <i class="layui-icon">&#xe651;</i>暂停续费
        </button>
        <button class="layui-btn layui-btn-sm layui-btn-danger" lay-event="batchUpdateRenewalStatusToSoldOut">
            <i class="layui-icon">&#xe601;</i>下架整站
        </button>
        <button class="layui-btn layui-btn-sm" lay-event="batchUpdateRenewalStatusToOther">
            <i class="layui-icon">&#xe63f;</i>改为其他
        </button>
    </div>
    </@shiro.hasRole>
</script>

<script type="text/html" id="item">
    <div onmouseover="showOperation(this)" onmouseout="hideOperation(this)">
    <div class="layui-row header">
        <!--    头部信息栏    -->
        <div class="layui-col-md7">
            <input type="hidden" name="uuid" value="{{d.uuid}}">
            <input type="hidden" name="PCGroup" value="{{d.pcGroup}}">
            <input type="hidden" name="PhoneGroup" value="{{d.phoneGroup}}">
            <span class="contactPerson-name" title="{{d.contactPerson}}"><a href="javascript:;">{{d.contactPerson}}</a></span>
            <span class="domain" title="{{d.domain}}"><a href="http://{{d.domain.trim()}}" target="_blank" title="查看官网">{{d.domain.trim()}}</a></span>
            <span class="organization-name" title="{{d.organizationName}}"><a href="javascript:;">{{d.organizationName}}</a></span>
            <span class="to-aizhan"><a href="https://www.aizhan.com/cha/{{d.domain.trim()}}" target="_blank" title="查看爱站">爱站</a></span>
            <span class="to-5118"><a href="https://www.5118.com/seo/{{d.domain.trim()}}" target="_blank" title="查看5118">5118</a></span>
            <span>
                自动采词:
                <a href="javascript:;">
                    {{#  if(d.autoCrawlKeywordFlag) { }}
                        是
                    {{#  }else{ }}
                        否
                    {{# } }}
                </a>
            </span>
            <span>
                爬取状态:
                <a href="javascript:;">
                    {{#  if(d.crawlerStatus === 'new') { }}
                        未爬取
                    {{#  }else if(d.crawlerStatus === 'processing') { }}
                        爬取中
                    {{# }else{ }}
                        爬取完成
                    {{# } }}
                </a>
            </span>
            <span>
                达标时间:
                <a href="javascript:;">
                    {{d.standardTime == null ? "暂无" :layui.util.toDateString(d.standardTime, 'yyyy-MM-dd')}}
                </a>
            </span>
            <span>
                创建时间:
                <a href="javascript:;">
                    {{d.createTime == null ? "暂无" :layui.util.toDateString(d.createTime, 'yyyy-MM-dd')}}
                </a>
            </span>
        </div>
        <!--    标签    -->
        <div class="layui-col-md1">
            <span class="tagNames">
                <label>标签:</label>&nbsp;&nbsp;
                <a class="tagNameStr" id="tagName_{{d.uuid}}" href="javascript:editTagNameStr('{{d.uuid}}');" title="">暂无</a>
            </span>
        </div>
        <!--     操作栏   -->
        <div class="layui-col-md4">
            <div class="handle" id="operation" style="display: none">
                <span>
                    <a class="blue"
                       href="javascript:showExcludeCustomerKeywordDialog(
                       '{{d.uuid}}','{{d.customerUuid}}','{{d.domain.trim()}}',
                       '{{d.pcGroup}}', '{{d.phoneGroup}}')">排除关键字</a>
                </span>
            <@shiro.hasPermission name="/internal/qzsetting/save">
                <span>
                    <a class="blue"
                       href="javascript:showAddKeywordDialog('{{d.uuid}}',
                       '{{d.customerUuid}}','{{d.domain.trim()}}','{{d.bearPawNumber}}',
                       '{{d.searchEngine}}', '{{d.type}}', '{{d.pcGroup}}',
                       '{{d.phoneGroup}}')">添加关键字</a>
                </span>
            </@shiro.hasPermission>
            <@shiro.hasPermission name="/internal/usernotebook/searchUserNoteBooks">
                <span>
                    <a class="blue"
                       href="javascript:openNoteBookDialog('{{d.customerUuid}}')">运营记录</a>
                </span>
        </@shiro.hasPermission>
        <@shiro.hasPermission name="/internal/qzchargelog/save">
                <span>
                    <a class="blue"
                       href="javascript:showChargeDialog('{{d.uuid}}','{{d.contactPerson}}',
                      '{{d.domain.trim()}}','{{d.renewalStatus}}')">收费</a>
                </span>
            </@shiro.hasPermission>
            <@shiro.hasPermission name="/internal/qzchargelog/chargesList">
                <span>
                    <a class="blue" href="javascript:showChargeLog('{{d.uuid}}')">收费记录</a>
                </span>
            </@shiro.hasPermission>
                <span>
                    <a class="blue" href="javascript:showChargeStatus('{{d.uuid}}')">续费状态记录</a>
                </span>
            <@shiro.hasPermission name="/internal/qzsetting/save">
                <span>
                    <a class="blue" href="javascript:" onclick="showSettingDialog('{{d.uuid}}')">修改</a>
                </span>
            </@shiro.hasPermission>
            <@shiro.hasPermission name="/internal/qzsetting/delete">
                <span>
                    <a class="blue" href="javascript:delQZSetting('{{d.uuid}}')">删除</a>
                </span>
            </@shiro.hasPermission>
            </div>
        </div>
    </div>
    <div class="layui-row body">
        <!--   身体左侧基本信息    -->
        <div class="layui-col-md2 user-id">
            <div class="layui-col-md12 line1">
                <div class="layui-col-md12">
                    <a href="javascript:;">
                        <span title="{{d.userID}}">{{d.userID}}</span>
                    </a>
                </div>
                <div class="layui-col-md12">
                    <span>用户</span>
                </div>
            </div>
        </div>

        <div class="layui-col-md2 standard-info">
            <div class="layui-col-md12 line1">
                <div class="layui-col-md12">
                    <span class="show-table">
                        <a href="javascript:;" qzsettinguuid="{{d.uuid}}">
                        {{#  if(d.organizationName !== '优化部') { }}
                            <font  onmouseover="showTableTip(this,'{{d.uuid}}')" onmouseout="closeTableTip()"
                                   style="background-color: palevioletred;font-size: 14px;">￥ 0</font>
                        {{#  } }}
                        </a>
                    </span>
                </div>
                <div class="layui-col-md12">
                    <span>达标信息</span>
                </div>
            </div>
        </div>

        <div class="layui-col-md3 other-rank">
            <div class="layui-col-md12 line1">
                <div class="layui-col-md12">
                    <span>
                        <input type="hidden" id="cus_uuid" value="{{d.customerUuid}}">
                        <div name="activeCount">
                            <label>激活: </label>
                            <a href="javascript:searchCustomerKeywords('{{d.customerUuid}}', '{{d.pcGroup}}', '{{d.phoneGroup}}', '{{d.searchEngine}}', 1);">0</a>
                        </div>
                        <div name="stopCount">
                            <label>暂停: </label>
                            <a href="javascript:searchCustomerKeywords('{{d.customerUuid}}', '{{d.pcGroup}}', '{{d.phoneGroup}}', '{{d.searchEngine}}', 0);">0</a>
                        </div>
                     </span>
                </div>
                <div class="layui-col-md12">
                    <span class="click-czcs" onclick="toCustomerKeywordFromQZ('{{d.customerUuid}}', '{{d.pcGroup}}', '{{d.phoneGroup}}')">操作词数</span>
                </div>
            </div>
            <div class="layui-col-md12 line1">
                <div class="layui-col-md12">
                    <span style="cursor: pointer" onmouseover="showTip(this,'{{d.chargeStatusUuid}}')" onmouseout="closeTip()">
                        {{#  if(d.renewalStatus === 1) { }}
                            <span style="color: green;">续费中</span>
                        {{# }else if(d.renewalStatus === 0) { }}
                            <span style="color: palevioletred;">暂停续费</span>
                        {{# }else if(d.renewalStatus === 2) { }}
                            <span style="color: mediumseagreen;">首次收费</span>
                        {{# }else if(d.renewalStatus === 3) { }}
                            <span style="color: red;">下架</span>
                        {{# }else if(d.renewalStatus === 4) { }}
                            <span style="color: mediumseagreen;">其他</span>
                        {{# } }}
                    </span>
                </div>
                <div class="layui-col-md12">
                    <span>续费状态</span>
                </div>
            </div>
        </div>

        <div class="layui-col-md4 other-rank_2">
            <div class="layui-col-md12 line1">
                <div class="layui-col-md12" id="optimizationGroup">
                    <span><a href="javascript:;">暂无</a></span>
                </div>
                <div class="layui-col-md12">
                    <span>优化分组</span>
                </div>
            </div>
            <div class="layui-col-md12 line1">
                <div class="layui-col-md12" id="operationCombine">
                    <span><a href="javascript:;">暂无</a></span>
                </div>
                <div class="layui-col-md12 operationCombineSpan">
                    <span>操作组合</span>
                </div>
            </div>
        </div>
        <!--   身体右侧曲线    -->
        <!--排名曲线-->
        <div class="layui-col-md2 rank-wrap2">
            <div class="layui-col-md2 col-1" id="xtCharts"
                 style="position:static !important; -webkit-tap-highlight-color: transparent; user-select: none;"></div>
        </div>
        <!--5118/爱站曲线-->
        {{# if(d.searchEngine === '百度') { }}
        <div class="layui-col-md5 rank-wrap">
            <div class="layui-col-md3 col-2" id="keywordTrendCharts"
                 style="position:static !important; -webkit-tap-highlight-color: transparent; user-select: none;"></div>
            <div class="layui-col-md2 col-4 top50-link">
                <div class="row4">
                    <span>前10</span>
                    <span class="top10">
                            <a href="javascript:;" id="Top10">0</a>
                        </span>
                </div>
                <div class="row4">
                    <span>前50</span>
                    <span class="top50">
                            <a href="javascript:;" id="Top50">0</a>
                        </span>
                </div>
                <div class="row4">
                    <span>初始前10</span>
                    <span class="top10">
                            <a href="javascript:;" id="TopCreate10">0</a>
                        </span>
                </div>
                <div class="row4">
                    <span>初始前50</span>
                    <span class="top50">
                            <a href="javascript:;" id="TopCreate50">0</a>
                        </span>
                </div>
                <div class="row4">
                    <span>曲线达标</span>
                    <span class="isStandard">
                            <a href="javascript:;" id="IsStandard">否</a>
                        </span>
                </div>
                <div class="row4">
                    <span>达标时间</span>
                    <span class="standardTime">
                            <a href="javascript:;" id="StandardTime">无</a>
                        </span>
                </div>
            </div>
        </div>
        {{# } }}
        <!--指定词曲线-->
        <div class="layui-col-md5 rank-wrap1">
            <div class="layui-col-md3 col-1" id="designationWordCharts"
                 style="position:static !important; -webkit-tap-highlight-color: transparent; user-select: none;"></div>
            <div class="layui-col-md2 col-5 top50-link">
                <div class="row4">
                    <span>前10</span>
                    <span class="top10">
                        <a href="javascript:;" id="Top10">0</a>
                    </span>
                </div>
                <div class="row4">
                    <span>前50</span>
                    <span class="top50">
                        <a href="javascript:;" id="Top50">0</a>
                    </span>
                </div>
                <div class="row4">
                    <span>初始前10</span>
                    <span class="top10">
                        <a href="javascript:;" id="TopCreate10">0</a>
                    </span>
                </div>
                <div class="row4">
                    <span>初始前50</span>
                    <span class="top50">
                        <a href="javascript:;" id="TopCreate50">0</a>
                    </span>
                </div>
                <div class="row4">
                    <span>曲线达标</span>
                    <span class="isStandard">
                        <a href="javascript:;" id="IsStandard">否</a>
                    </span>
                </div>
                <div class="row4">
                    <span>达标时间</span>
                    <span class="standardTime">
                        <a href="javascript:;" id="StandardTime">无</a>
                    </span>
                </div>
            </div>
        </div>
    </div>
    </div>
</script>
</body>
</html>