<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.keymanager.monitoring.dao.KeywordInfoDao">

    <sql id="keywordinfoSQL">
        fId AS "id",
        fUserName as "userName",
        fSpliterStr as "spliterStr",
        fSearchEngine as "searchEngine",
        fOperationType as "operationType",
        fKeywordInfo as "keywordInfo",
        fStatus as "status",
        fUpdateTime as "updateTime",
        fCreateTime as "createTime"
    </sql>


    <insert id="batchInsertKeyword" parameterType="com.keymanager.monitoring.vo.KeywordInfoVO">
        INSERT INTO
            t_keyword_info(fId, fUserName, fSpliterStr, fSearchEngine, fOperationType, fKeywordInfo, fStatus, fUpdateTime, fCreateTime)
        VALUES
        <foreach collection="keywordInfoVO" item="vo" separator=",">
            (NULL,
            #{vo.userName},
            #{vo.spliterStr},
            #{vo.searchEngine},
            #{vo.operationType},
            #{vo.keywordInfo},
            '上线',
            #{vo.updateTime},
            #{vo.createTime})
        </foreach>
    </insert>


    <select id="searchKeywordInfo" parameterType="com.keymanager.monitoring.criteria.KeywordInfoCriteria" resultType="com.keymanager.monitoring.entity.KeywordInfo">
        SELECT
        <include refid="keywordinfoSQL" />
        FROM
        t_keyword_info kif
        WHERE 1 = 1
        <if test="keywordInfoCriteria.UserName != null and keywordInfoCriteria.UserName != ''">AND kif.fUserName LIKE '%${keywordInfoCriteria.userName}%'</if>
        <if test="keywordInfoCriteria.Monitoring != null and keywordInfoCriteria.Monitoring != ''">AND kif.fSearchEngine LIKE '${keywordInfoCriteria.monitoring}%'</if>
        <if test="keywordInfoCriteria.platform != null and keywordInfoCriteria.platform != ''">AND kif.fSearchEngine LIKE '%${keywordInfoCriteria.platform}'</if>
        <if test="keywordInfoCriteria.OperationType != null and keywordInfoCriteria.OperationType != ''">AND kif.fOperationType = #{keywordInfoCriteria.operationType}</if>
        <if test="keywordInfoCriteria.keywordInfo != null and keywordInfoCriteria.keywordInfo != ''">AND kif.fKeywordInfo LIKE '%${keywordInfoCriteria.keywordInfo}%'</if>
        <if test="keywordInfoCriteria.createTime != null and keywordInfoCriteria.createTime !='' ">AND DATE_FORMAT(kif.fCreateTime,'%Y-%m-%d') = #{keywordInfoCriteria.createTime}</if>
        ORDER BY createTime DESC
    </select>

</mapper>