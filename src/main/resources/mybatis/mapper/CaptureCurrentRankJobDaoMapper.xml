<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.keymanager.monitoring.dao.CaptureCurrentRankJobDao">
    <sql id="colID">
        c.fUuid AS `uuid`,
        c.fGroupNames AS `groupNames`,
        c.fCustomerIds AS `customerIds`,
        c.fOperationType AS `operationType`,
        c.fExectionTime AS `exectionTime`,
        c.fExectionStatus  AS `exectionStatus`,
        c.fStartTime AS `startTime`,
        c.fEndTime AS `endTime`,
    </sql>
    <select id="searchCaptureCurrentRankJobs" resultType="com.keymanager.monitoring.entity.CaptureCurrentRankJob">
         select c.fUuid as uuid,c.fGroupNames AS `groupNames`,c.fCustomerIds AS `customerIds` from t_capture_current_rank_job c
         where
            c.fExectionStatus='prepared' or
            (c.fExectionStatus='complete' and c.fOperationType='everyday' and DATE_FORMAT(c.fEndTime,'%Y-%m-%d')=(date_sub(curdate(),interval 1 day)))
    </select>
</mapper>