<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.keymanager.monitoring.dao.PtCustomerKeywordDao">

    <sql id="cmsKeywordColID">
        SELECT
            ID AS 'id',
            CUSTOMER_KEYWORD_ID AS 'customerKeywordId',
            KEYWORD AS 'keyword',
            URL AS 'url',
            TITLE AS 'title',
            SEARCH_ENGINE AS 'searchEngine',
            TERMINAL_TYPE AS 'terminalType',
            BEAR_PAW_NUM AS 'bearPawNumber',
            PRICE_PER_DAY AS 'pricePreDay',
            CURRENT_POSITION AS 'currentPosition',
            STATUS AS 'status',
            CITY AS 'city',
            COMPANY_CODE AS 'companyCode',
            CAPTURE_POSITION_CITY AS 'capturePositionCity',
            CAPTURE_POSITION_TIME AS 'capturePositionTime',
            CAPTURE_STATUS AS 'captureStatus',
            CREATE_TIME AS 'createTime',
            UPDATE_TIME AS 'updateTime'
        FROM cms_keyword
    </sql>

    <select id="selectExistingCmsKeyword" resultType="com.keymanager.monitoring.entity.PtCustomerKeyword">
        <include refid="cmsKeywordColID"/>
        WHERE CUSTOMER_KEYWORD_ID = #{customerKeywordId}
        LIMIT 1
    </select>

    <select id="checkFinishedCapturePosition" resultType="java.lang.Integer">
        SELECT COUNT(1) FROM cms_keyword WHERE STATUS = 1 AND CAPTURE_POSITION_TIME &lt; CURRENT_DATE()
    </select>

</mapper>