<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.keymanager.monitoring.dao.KeywordManagerSessionDao">

    <sql id="selectCol">
        kms.fUuid          AS 'uuid',
        kms.fSessionID     AS 'sessionID',
        kms.fAttributeName AS 'attributeName',
        kms.fContent       AS 'content',
        kms.fStatus        AS 'status',
        kms.fCreateTime    AS 'createTime',
        kms.fUpdateTime    AS 'updateTime'
    </sql>

    <select id="findExistingKeywordManagerSession" resultType="com.keymanager.monitoring.entity.KeywordManagerSession">
        SELECT
            <include refid="selectCol" />
        FROM t_keyword_manager_session kms
        WHERE kms.fSessionID = #{sessionID}
        AND kms.fAttributeName = #{attributeName}
        LIMIT 1
    </select>

    <select id="searchKeywordManagerSessions" resultType="com.keymanager.monitoring.entity.KeywordManagerSession">
        SELECT
            <include refid="selectCol" />
        FROM t_keyword_manager_session kms
        WHERE 1 = 1
        <if test="criteria.sessionID != null and criteria.sessionID != ''">AND kms.fSessionID = #{criteria.sessionID}</if>
        <if test="criteria.attributeName != null and criteria.attributeName != ''">AND kms.fAttribateName = #{criteria.attributeName}</if>
        ORDER BY kms.fCreateTime DESC
    </select>
</mapper>
