<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.keymanager.ckadmin.dao.QzChargeMonDao">
    <!--查询一条操作类型信息-->
    <select id="getQZChargeMonData" resultType="java.util.HashMap">
        SELECT
            SUM(IF(fOperationType = 0, 1, 0))  AS 'stopQzData',
            SUM(IF(fOperationType = 1, 1, 0)) AS 'renewalQzData',
            SUM(IF(fOperationType = 2, 1, 0))  AS 'addQzData',
            SUM(IF(fOperationType = 3, 1, 0))  AS 'obtainedQzData',
            SUM(IF(fOperationType = 4, 1, 0))  AS 'deleteQzData',
            DATE_FORMAT(fOperationDate, '%Y-%m-%d') AS 'monthDate'
        FROM t_qz_charge_mon
        WHERE fOperationDate BETWEEN #{condition.ltDate}  AND #{condition.gtDate}
        <if test="condition.searchEngine != null and condition.searchEngine != ''">
            AND fSearchEngine = #{condition.searchEngine}
        </if>
        <if test="condition.terminal != null and condition.terminal != ''">
            AND fTerminalType = #{condition.terminal}
        </if>
        GROUP BY DATE_FORMAT(fOperationDate, '%Y-%m-%d')
    </select>
</mapper>